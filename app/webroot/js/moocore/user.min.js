(function(a,c){"function"===typeof define&&define.amd?define("jquery mooPhrase mooFileUploader mooAlert mooGlobal mooButton mooOverlay mooBehavior mooAjax mooTooltip spinner tipsy multiselect Jcrop bootstrap".split(" "),c):"object"===typeof exports?module.exports=c(require("jquery")):a.mooUser=c()})(this,function(a,c,q,h,r,g,y,u,p,z){var v=function(){new q.fineUploader({element:a("#profile_picture")[0],request:{endpoint:mooConfig.url.base+"/upload/avatar_tmp"},text:{uploadButton:'<div class="upload-section"><i class="material-icons">photo_camera</i> '+
            c.__("drag_or_click_here_to_upload_photo")+"</div>"},validation:{allowedExtensions:mooConfig.photoExt,sizeLimit:mooConfig.sizeLimit},multiple:!1,callbacks:{onError:r.errorHandler,onComplete:function(b,d,c){a("#profile_picture_preview > img").attr("src",mooConfig.url.base+"/uploads/tmp/"+c.filename);a("#profile_picture_preview > img").show();a("#profile_picture_preview > img").css({height:"150px"});a("#avatar").val(c.filepath)}}})},t=function(a){k=a.x;l=a.y;m=a.w;n=a.h},w,k=0,l=0,m=0,n=0;n=m=l=k=0;
    var A=function(b,d){a.post(mooConfig.url.base+"/friends/ajax_respond",{id:b,status:d},function(a){location.reload()})},B=function(){g.disableButton("checkButton");a.post(mooConfig.url.base+"/users/ajax_username",{username:a("#username").val()},function(b){g.enableButton("checkButton");b=a.parseJSON(b);a("#message").html(b.message);1==b.result?a("#message").css("color","green"):a("#message").css("color","red");a("#message").show()})},D=function(){a(".removeMember").unbind("click");a(".removeMember").on("click",
        function(){var b=a(this).data();C(b.id)})},F=function(){a(".changeAdmin").unbind("click");a(".changeAdmin").on("click",function(){var b=a(this).data();E(b.id,b.type)})},C=function(b){a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),callback:function(){a.post(mooConfig.url.base+"/groups/ajax_remove_member",{id:b},function(){a("#member_"+b).fadeOut();"0"!=a("#group_user_count").html()&&a("#group_user_count").html(parseInt(a("#group_user_count").html())-1)})},title:c.__("please_confirm"),
            contents:c.__("are_you_sure_you_want_to_remove_this_member"),model:"confirm",hideFooter:!1,closeButton:!1}).showModal();return!1},E=function(b,d){var f=c.__("are_you_sure_you_want_to_make_this_member_a_group_admin");"remove"==d&&(f=c.__("are_you_sure_you_want_to_demote_this_group_admin"));a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),callback:function(){a.post(mooConfig.url.base+"/groups/ajax_change_admin",{id:b,type:d},function(){window.location.reload()})},title:c.__("please_confirm"),
            contents:f,model:"confirm",hideFooter:!1,closeButton:!1}).showModal();return!1},x=function(){a(".respondRequest").unbind("click");a(".respondRequest").on("click",function(){a(".respondRequest").unbind("click");var b=a(this).data();A(b.id,b.status)});a(".user_action_follow").unbind("click");a(".user_action_follow").click(function(){element=a(this);a.ajax({type:"POST",url:mooConfig.url.base+"/follows/ajax_update_follow",data:{user_id:a(this).data("uid")},success:function(a){element.data("follow")?(element.data("follow",
            0),element.find(".hidden-xs").html(c.__("text_follow")),element.find(".visible-xs").html("rss_feed")):(element.data("follow",1),element.find(".hidden-xs").html(c.__("text_unfollow")),element.find(".visible-xs").html("check"))}})})},G=function(b){a("#user_photos").spin("tiny");a("#user_photos").children(".badge_counter").hide();a("#profile-content").load(mooConfig.url.base+"/photos/profile_user_album/"+b,{noCache:1},function(b){a(this).html(b);a("#user_photos").spin(!1);a("#user_photos").children(".badge_counter").fadeIn()})},
        H=function(){var a=0;return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}();return{validateUser:function(){if("undefined"==typeof mooViewer)return a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),model:"modal",title:c.__("warning"),contents:c.__("please_login")}).showModal(),!1;if(mooCore["setting.require_email_validation"]&&!mooViewer.is_confirmed)return a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),model:"modal",title:c.__("warning"),contents:c.__("please_confirm_your_email")}).showModal(),
            !1;if(mooCore["setting.approve_users"]&&!mooViewer.is_approved)return a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),model:"modal",title:c.__("warning"),contents:c.__("your_account_is_pending_approval")}).showModal(),!1;var b={status:!0,message:""};a("body").trigger("validateUser",[b]);return b.status?!0:(a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),model:"modal",title:c.__("warning"),contents:b.message}).showModal(),!1)},initOnRegistration:function(){a("#username").keyup(function(){var b=
            "";""!=a("#username").val().trim()&&(b="-"+a("#username").val().trim());a("#profile_user_name").html(b)});a("#submitFormsignup").unbind("click");a("#submitFormsignup").click(function(){a("#step1Box").spin("small");a("#submitFormsignup").attr("disabled","disabled");a.post(mooConfig.url.base+"/users/ajax_signup_step1",a("#regForm").serialize(),function(b){a("#step1Box").spin(!1);b=JSON.parse(b);0==b.result?(a("#regError").fadeIn(),a("#regError").html(b.error),a("#submitFormsignup").removeAttr("disabled")):
            (a("#regError").fadeOut(),window.location=b.redirect)})});a("#step2Submit").unbind("click");a("#step2Submit").click(function(){a("#tos").is(":checked")?(a("#step2Box").spin("small"),a("#step2Submit").attr("disabled","disabled"),a.post(mooConfig.url.base+"/users/ajax_signup_step2",a("#regForm").serialize(),function(b){a("#step2Box").spin(!1);var d="",c=!1;try{d=JSON.parse(b),c=!0}catch(e){}c?d.redirect&&(window.location=d.redirect):""!=b?(a("#regError").fadeIn(),a("#regError").html(b),a("#step2Submit").removeAttr("disabled"),
            grecaptcha.reset()):window.location=mooConfig.url.base+"/"})):(a("#regError").fadeIn(),a("#regError").html(c.__("you_have_to_agree_with_term_of_service")))})},initOnSignupStep1:v,initOnSignupStep1FieldCountry:function(){a("#country_id").unbind("change");a("#country_id").change(function(){a(".country_state").hide();a("#state_id").html("<option value=''></option>");""!=a("#country").val()&&a.getJSON(mooConfig.url.base+"/countries/ajax_get_state/"+a("#country_id").val(),function(b){0<b.count&&(a(".country_state").show(),
            a.each(b.data,function(d){a("#state_id").append("<option value='"+b.data[d].id+"'>"+b.data[d].name+"</option>")}))})})},initOnProfilePicture:function(){a("#save-avatar").unbind("click");a("#save-avatar").click(function(){var b=a(this).data();0==k&&0==l&&0==m&&0==n&&1==b.upload?h.alert(c.__("please_select_area_for_cropping")):(1==b.upload&&(a("#avatar_wrapper").spin("large"),a("#portlet-config"),a.post(mooConfig.url.base+"/upload/thumb",{x:k,y:l,w:m,h:n},function(b){a("#avatar_wrapper").spin(!1);""!=
        b&&(b=a.parseJSON(b),a("#member-avatar").attr("src",b.thumb))})),a.post(mooConfig.url.base+"/users/save_setting",a("#form_show_info").serialize(),function(a){window.location=b.url}))});mooConfig.isMobile?(a("#save-avatar").addClass("hide"),a("#submit-avatar").removeClass("hide")):a("#av-img2").Jcrop({aspectRatio:1,onSelect:t,minSize:[180,180]},function(){w=this});new q.fineUploader({element:a("#select-0")[0],multiple:!1,text:{uploadButton:'<div class="upload-section"><i class="material-icons">photo_camera</i> '+
                    c.__("drag_or_click_here_to_upload_photo")+"</div>"},validation:{allowedExtensions:mooConfig.photoExt,sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+"/upload/avatar"},callbacks:{onError:r.errorHandler,onComplete:function(b,d,c){a("#av-img").attr("src",c.avatar);a("#av-img2").attr("src",c.avatar);a("#member-avatar").attr("src",c.thumb);a("#save-avatar").attr("data-upload",1);w.setImage(c.avatar)}}})},initAddFriend:function(){a("#sendReqAddFriendBtn").unbind("click");a("#sendReqAddFriendBtn").click(function(){var b=
            a(this).data().uid;a("#sendReqAddFriendBtn").spin("small");g.disableButton("sendReqAddFriendBtn");a.post(mooConfig.url.base+"/friends/ajax_sendRequest",a("#addFriendForm").serialize(),function(d){a(".suggestion_block").length&&(a(".suggestion_block #addFriend_"+b).parents("li:first").remove(),0==a(".suggestion_block li").length&&a(".suggestion_block").remove());g.enableButton("sendReqAddFriendBtn");a("#themeModal").modal("hide");a("#addFriend_"+b).parents("div.user-idx-item").append('<a href="'+mooConfig.url.base+
            "/friends/ajax_cancel/"+b+'" id="cancelFriend_'+b+'" class="add_people" title="'+c.__("cancel_a_friend_request")+'"><i class="material-icons">clear</i>'+c.__("cancel_request")+"</a>");a("#addFriend_"+b).remove();a("#blogAddFriend").length&&(a("#blogAddFriend").parents(".blog_view_leftnav").append('<li><a href="'+mooConfig.url.base+"/friends/ajax_cancel/"+b+'" id="blogCancelFriend" class="" title="'+c.__("cancel_a_friend_request")+'"><i class="material-icons icon-small">clear</i>'+c.__("cancel_request")+
            "</a></li>"),a("#blogAddFriend").parents("li:first").remove());a("#userAddFriend").length&&(a("#userAddFriend").parents(".profile-action").append('<a id="userCancelFriend" href="'+mooConfig.url.base+"/friends/ajax_cancel/"+b+'" class="topButton button button-action" title="'+c.__("cancel_a_friend_request")+'"><i class="visible-xs visible-sm material-icons">clear</i><i class="hidden-xs hidden-sm">'+c.__("cancel_request")+"</i></a>"),a("#userAddFriend").remove());location.reload()});return!1})},initBirthdayPopup:function(){a(".more-birthday-email").unbind("click");
            a(".more-birthday-email").click(function(){a("#langModal").modal("show")&&a("#langModal").modal("hide")});a(".postFriendWall").unbind("click");a(".postFriendWall").click(function(){var b=a(this).data("id"),d=a(this),f=a("#message_"+b).val();""!=a.trim(f)&&(g.disableButton("status_btn_"+b),a.post(mooConfig.url.base+"/activities/send_birthday_wish",a("#wallForm_"+b).serialize(),function(e){e=a.parseJSON(e);g.enableButton("status_btn_"+b);a("#message_"+b).val("");e.success&&(g.enableButton("status_btn_"+
                b),d.parent(".birthday-wish").html("<div style='padding:5px 0px;'>"+c.__("birthday_wish_is_sent")+"</div>"))}))})},initEditCoverPicture:function(){function b(a,b,d){window.URL=window.URL||window.webkitURL;a=d.getFile(a);d=new Image;var e={};d.onerror=function(a){e.error=c.__("cannot_determine_dimensions_for_image_may_be_too_large")};d.onload=function(){e={width:this.width,height:this.height};var a=e.height>=b[1];e.width>=b[0]&&a?f.uploadStoredFiles():(f.clearStoredFiles(),h.alert(c.__("please_choose_an_image_that_s_at_least_400_pixels_wide_and_at_least_150_pixels_tall")))};
            d.src=window.URL.createObjectURL(a)}var d;mooConfig.isMobile||a("#cover-img").Jcrop({aspectRatio:4,onSelect:t,minSize:[400,200],boxWidth:570},function(){d=this});var f=new q.fineUploader({element:a("#select-1")[0],multiple:!1,autoUpload:!1,text:{uploadButton:'<div class="upload-section"><i class="material-icons">photo_camera</i>'+c.__("drag_or_click_here_to_upload_photo")+"</div>"},validation:{allowedExtensions:mooConfig.photoExt,sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+
                    "/upload/cover"},callbacks:{onSubmit:function(a,d){return b(a,[400,150],this)},onError:r.errorHandler,onComplete:function(b,c,f){a("#cover_img_display").attr("src",f.cover);mooConfig.isMobile?a("#cover_wrapper img").attr("src",f.photo):d.setImage(f.photo)}}})},initEditProfilePicture:function(){var b;mooConfig.isMobile?a(".modal-footer").addClass("hide"):a("#av-img2").Jcrop({aspectRatio:1,onSelect:t,minSize:[180,180],boxWidth:570},function(){b=this});new q.fineUploader({element:a("#select-0")[0],multiple:!1,
            text:{uploadButton:'<div class="upload-section"><i class="material-icons">photo_camera</i>'+c.__("drag_or_click_here_to_upload_photo")+"</div>"},validation:{allowedExtensions:mooConfig.photoExt,sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+"/upload/avatar"},callbacks:{onError:r.errorHandler,onComplete:function(d,c,e){a("#av-img").attr("src",e.avatar_mini);mooConfig.isMobile?a("#avatar_wrapper img").attr("src",e.avatar):b.setImage(e.avatar);a("#member-avatar").attr("src",e.thumb)}}})},
        initRemoveFriend:function(){a("#removeFriendButton").unbind("click");a("#removeFriendButton").click(function(){var b=a(this).data().uid;g.disableButton("removeFriendButton");a.post(mooConfig.url.base+"/friends/ajax_removeRequest",a("#removeFriendForm").serialize(),function(d){g.enableButton("removeFriendButton");a("#themeModal").modal("hide");d=a("#removeFriend_"+b).parents("li:first");var c=d.parents('li[id^="activity_"]');d.remove();c.remove();location.reload()});return!1})},initOnProfileEdit:function(){a(".multi").multiSelect({selectAll:!1,
            noneSelected:"",oneOrMoreSelected:c.__("per_selected")});a("#username").keyup(function(){var b="";""!=a("#username").val().trim()&&(b="-"+a("#username").val().trim());a("#profile_user_name").html(b)});a("#checkButton").unbind("click");a("#checkButton").click(function(){B()})},initOnUserList:function(){a("#list-content li").hover(function(){a(this).contents().find(".delete-icon").show()},function(){a(this).contents().find(".delete-icon").hide()});x();D();F();u.initMoreResults()},initAjaxRequest:function(){a(".respondRequest").unbind("click");
            a(".respondRequest").on("click",function(){a(this).addClass("disabled");var b=a(this).data();if(0<a("#friend_request_count").length){var d=a("#friend_request_count").html();d=parseInt(d-1);0>=d?a("#friend_request_count").parents("li:first").remove():a("#friend_request_count").html(d)}a.post(mooConfig.url.base+"/friends/ajax_respond",{id:b.id,status:b.status},function(d){a("#request_"+b.id).html(d)})})},initAjaxRequestPopup:function(){a(".respondRequest").unbind("click");a(".respondRequest").on("click",
            function(){a(this).addClass("disabled");var b=a(this).data();a.post(mooConfig.url.base+"/friends/ajax_respond",{id:b.id,status:b.status},function(d){a("#request_"+b.id).html(d);location.reload()})})},initShowAlbums:function(){a(".showAlbums").unbind("click");a(".showAlbums").on("click",function(){G(a(this).data("userId"))})},initRespondRequest:x,initOnUserIndex:function(){a(".multi").multiSelect({selectAll:!1,noneSelected:"",oneOrMoreSelected:c.__("per_selected")});a("#searchPeople").unbind("click");
            a("#searchPeople").click(function(){a("#everyone a").spin("tiny");a("#browse .current").removeClass("current");a("#everyone").addClass("current");a.post(mooConfig.url.base+"/users/ajax_browse/search",a("#filters").serialize(),function(b){a("#everyone a").spin(!1);a("#list-content").html(b);y.registerOverlay()});992>a(window).width()&&(a("#leftnav").modal("hide"),a("body").scrollTop(0))})},initOnUserProfile:function(){a(".deactiveMyAccount").unbind("click");a(".deactiveMyAccount").on("click",function(){h.confirm(c.__("confirm_deactivate_account"),
            mooConfig.url.base+"/users/deactivate")});a(".deleteMyAccount").unbind("click");a(".deleteMyAccount").on("click",function(){h.confirm(c.__("confirm_delete_account"),mooConfig.url.base+"/users/delete_account")});a(".specialty").on("click",function(){var b=a(this).val();switch(parseInt(b)){case 1:a("#university_info").show();break;case 2:a("#university_info").show();break;case 3:a("#university_info").hide()}});a(".univer_radio").on("change",function(){a("#university").val("")});a("#save_profile").click(function(b){b.preventDefault();
            button=a(this);button.addClass("disabled");p.post({url:mooConfig.url.base+"/users/ajax_save_profile",data:jQuery("#form_edit_user").serialize()},function(b){b=a.parseJSON(b);b.status?location.reload():(button.removeClass("disabled"),a(".error-message").show(),a(".error-message").html(b.message))});return!1});a("#save_profile_1").click(function(b){b.preventDefault();button=a(this);button.addClass("disabled");a(this).data();p.post({url:mooConfig.url.base+"/users/ajax_save_profile_1",data:jQuery("#form_edit_user").serialize()},
            function(b){b=a.parseJSON(b);b.status?b.message?a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("cancel"),title:c.__("message"),hideFooter:!1,closeButton:!1,model:"alert",contents:b.message,reload:1}).showModal():location.reload():(button.removeClass("disabled"),a(".error-message").show(),a(".error-message").html(b.message))});return!1});a("#save_profile_2").click(function(b){b.preventDefault();button=a(this);button.addClass("disabled");p.post({url:mooConfig.url.base+"/users/ajax_save_profile_2",
            data:jQuery("#form_edit_user").serialize()},function(b){b=a.parseJSON(b);b.status?location.reload():(button.removeClass("disabled"),a(".error-message").show(),a(".error-message").html(b.message))});return!1});a("#cancel_validation").click(function(b){b.preventDefault();button=a(this);button.addClass("disabled");p.post({url:mooConfig.url.base+"/users/ajax_revert/0"},function(b){b=a.parseJSON(b);b.status?location.reload():(button.removeClass("disabled"),a(".error-message").show(),a(".error-message").html(b.message))});
            return!1});a("#cancel_sub_validation").click(function(b){b.preventDefault();button=a(this);button.addClass("disabled");p.post({url:mooConfig.url.base+"/users/ajax_revert/1"},function(b){b=a.parseJSON(b);b.status?location.reload():(button.removeClass("disabled"),a(".error-message").show(),a(".error-message").html(b.message))});return!1})},initOnCloseNetworkSignup:function(b){a("#username").keyup(function(){var b="";""!=a("#username").val().trim()&&(b="-"+a("#username").val().trim());a("#profile_user_name").html(b)});
            a("#submitFormsignup").click(function(){a("#step1Box").spin("small");a("#submitFormsignup").attr("disabled","disabled");a.post(mooConfig.url.base+"/users/ajax_signup_step1",a("#regForm").serialize(),function(b){a("#step1Box").spin(!1);b=JSON.parse(b);0==b.result?(a("#regError").fadeIn(),a("#regError").html(b.error),a("#submitFormsignup").removeAttr("disabled")):(a("#regError").fadeOut(),window.location=b.redirect)})});a("#step2Submit").click(function(){if(a("#tos").is(":checked")){var d=!1;a("#step2Box").spin("small");
                a("#step2Submit").attr("disabled","disabled");a.post(mooConfig.url.base+"/users/ajax_signup_step2",a("#regForm").serialize(),function(c){a("#step2Box").spin(!1);var e="";try{e=JSON.parse(c),d=!0}catch(I){d=!1}d?e.redirect&&(window.location=e.redirect):""!=c?(a("#regError").fadeIn(),a("#regError").html(c),a("#step2Submit").removeAttr("disabled"),b&&grecaptcha.reset()):window.location=mooConfig.url.webroot})}else a("#regError").fadeIn(),a("#regError").html(c.__("you_have_to_agree_with_term_of_service"))})},
        resendValidationLink:function(){a("#resend_validation_link").unbind("click");a("#resend_validation_link").on("click",function(){a.post(mooConfig.url.base+"/users/resend_validation",{},function(a){h.alert(c.__("validation_link_has_been_resend"))})});a("#resend_sub_validation_link_0").unbind("click");a("#resend_sub_validation_link_0").on("click",function(){a.post(mooConfig.url.base+"/users/resend_sub_validation/0",{},function(a){h.alert(c.__("validation_link_has_been_resend"))})});a("#email").on("keyup",
            function(){""==a(this).val()?a(".btn-submit").attr("disabled","disabled"):a(".btn-submit").removeAttr("disabled")});a("#resend_validation_link_1").unbind("click");a("#resend_validation_link_1").on("click",function(){a.post(mooConfig.url.base+"/users/resend_validation/0",{email:a("#email").val()},function(b){b=a.parseJSON(b);1==b.status?(a("#resend_validation_link_1").hide(),a("#mail_input").html(a("#email").val()),a("#v_email").val(a("#email").val()),a("#input_mail").hide(),a("#sent_mail").show(),
            a("#btn_ok").show(),a("#error_message").hide(),a("#wrap_resend").show(),a("#btn_change_mail").hide()):(a("#error_message").html(b.message),a("#error_message").show())})});a("#resend_sub_validation_link").unbind("click");a("#resend_sub_validation_link").on("click",function(){a.post(mooConfig.url.base+"/users/resend_sub_validation/0",{email:a("#email").val()},function(b){b=a.parseJSON(b);1==b.status?(a("#resend_sub_validation_link").hide(),a("#mail_input").html(a("#email").val()),a("#input_mail").hide(),
            a("#sent_mail").show(),a("#error_message").hide(),a("#btn_ok").show(),a("#wrap_resend_sub").show(),a("#btn_change_submail").hide(),a("#v_sub_mail").val(a("#email").val())):(a("#error_message").html(b.message),a("#error_message").show())})});a("#update_email").unbind("click");a("#update_email").on("click",function(){var b=a(this).data();a.post(mooConfig.url.base+"/users/ajax_update_mail",{email:a("#email").val(),type:b.type},function(b){b=a.parseJSON(b);1==b.status?(a("#btn_cancel").trigger("click"),
            location.reload()):(a("#error_message").html(b.message),a("#error_message").show())})});a("#sms_verify_phone").on("keyup",function(){""==a(this).val()?a("#send_verify_mobile").attr("disabled","disabled"):a("#send_verify_mobile").removeAttr("disabled")});a("#send_verify_mobile").unbind("click");a("#send_verify_mobile").on("click",function(){a.post(mooConfig.url.base+"/sms_verifys/resend",{phone:a("#sms_verify_phone").val()},function(b){b=a.parseJSON(b);1==b.status?(a("#send_verify_mobile").html(c.__("resend")),
            a("#input_phone").hide(),a("#update_phone_section").show(),a("#btn_update_phone").show(),a("#error_message").hide()):("undefined"!=typeof b.message?a("#error_message").html(b.message):a("#error_message").html(c.__("something_went_wrong")),a("#error_message").show())})});a("#btn_update_phone").unbind("click");a("#btn_update_phone").on("click",function(){a.post(mooConfig.url.base+"/users/ajax_update_phone",{sms_verify_code:a("#sms_verify_code").val()},function(b){b=a.parseJSON(b);1==b.status?(a("#btn_cancel").trigger("click"),
            location.reload()):(a("#error_message").html(b.message),a("#error_message").show())})})},initOnSocialRegistration:function(b,d){a("#username").keyup(function(){var b="";""!=a("#username").val().trim()&&(b="-"+a("#username").val().trim());a("#profile_user_name").html(b)});a(".multi").multiSelect({selectAll:!1,noneSelected:"",oneOrMoreSelected:c.__("per_selected")});a("#step2Submit").click(function(){a("#tos").is(":checked")?(a("#step2Box").spin("small"),a("#step2Submit").attr("disabled","disabled"),
            a.post(mooConfig.url.base+"/social/auths/ajax_signup_step2/"+d,a("#regForm").serialize(),function(c){a("#step2Box").spin(!1);var d="",f=!1;try{d=JSON.parse(c),f=!0}catch(J){f=!1}f?d.redirect&&(window.location=d.redirect):""!=c?(a("#regError").fadeIn(),a("#regError").html(c),a("#step2Submit").removeAttr("disabled"),b&&grecaptcha.reset()):window.location=mooConfig.url.base+"/"})):(a("#regError").fadeIn(),a("#regError").html("You have to agree with term of service"))})},initOnUserView:function(){a("#themeModal").on("click",
            " .save-avatar",function(){a("#avatar_wrapper").spin("large");var b=a("#themeModal");a.post(mooConfig.url.base+"/upload/thumb",{x:k,y:l,w:m,h:n},function(c){b.modal("hide");""!=c&&(c=a.parseJSON(c),a("#member-avatar").attr("src",c.thumb),a("#av-img").attr("src",c.avatar_mini))})});a("#themeModal").on("click"," .save-cover",function(){var b=a("#themeModal");a("#cover_wrapper").spin("large");var c=a("#cover_wrapper .jcrop-holder").width(),f=a("#cover_wrapper .jcrop-holder").height();a.post(mooConfig.url.base+
            "/upload/thumb_cover",{x:k,y:l,w:m,h:n,jcrop_width:c,jcrop_height:f},function(c){b.modal("hide");""!=c&&(c=a.parseJSON(c),a("#cover_img_display").attr("src",c.thumb))})})},initBlockUser:function(){a("#blockUserButton").unbind("click");a("#blockUserButton").click(function(){a("#blockUserButton").spin("small");g.disableButton("blockUserButton");a.post(mooConfig.url.base+"/user_blocks/ajax_do_add",a("#blockUserForm").serialize(),function(b){g.enableButton("blockUserButton");a("#themeModal").modal("hide");
            window.location.href=mooConfig.url.base+"/"});return!1})},initUnBlockUser:function(){a("#unBlockUserButton").unbind("click");a("#unBlockUserButton").click(function(){a("#unBlockUserButton").spin("small");g.disableButton("unBlockUserButton");a.post(mooConfig.url.base+"/user_blocks/ajax_do_remove",a("#unBlockUserForm").serialize(),function(b){g.enableButton("unBlockUserButton");a("#themeModal").modal("hide");location.reload()});return!1})},initRemoveFollow:function(){a("#removeFollowButton").unbind("click");
            a("#removeFollowButton").click(function(){a(this).data();g.disableButton("removeFollowButton");a.post(mooConfig.url.base+"/follows/ajax_removeRequest",a("#removeFollowForm").serialize(),function(b){g.enableButton("removeFollowButton");a("#themeModal").modal("hide");a("#profile_follow").click();b=parseInt(a("#profile_follow .badge_counter").html());b--;a("#profile_follow .badge_counter").html(b)});return!1})},initSearchFriend:function(b){a("#search_friend").unbind("keyup");a("#search_friend").keyup(function(){H(function(){url=
            b?mooConfig.url.base+"/users/profile_user_friends/"+b:mooConfig.url.base+"/users/ajax_browse/home";a.post(url,{is_search:!0,search:a("#search_friend").val()},function(b){a("#list-content").html(b);u.initMoreResults();z.init()})},200)})},loadProfileType:function(b){a("#profile_type_id").change(function(){var d=a("#profile_type_id").val();a.get(mooConfig.url.base+"/users/ajax_loadfields/"+d+"/"+b,function(b){a(".custom-field").html(b);a(".multi").multiSelect({selectAll:!1,noneSelected:"",oneOrMoreSelected:c.__("per_selected")})})})},
        initRegStep2:function(b){v();a("#btn_submit_step_2").unbind("click");a("#btn_submit_step_2").click(function(){a("#btn_submit_step_2").spin("small");a.post(mooConfig.url.base+"/users/save_step_2/",a("#form_reg_step_2").serialize(),function(b){b=a.parseJSON(b);1==b.result?window.location=mooConfig.url.base+"/users/step_3":(a(".error-message").show(),a(".error-message").html(b.message));a("#btn_submit_step_2").spin(!1)})});a(".specialty").on("click",function(){var b=a(this).val();switch(parseInt(b)){case 1:a("#university_info").show();
            a(".hide-sale").show();break;case 2:a("#university_info").show();a(".hide-sale").show();break;case 3:a("#university_info").hide(),a(".hide-sale").show()}});a("#sub_mail").on("keyup",function(){var b=a(this).val();a("#sub_mail_txt").html(b);a("#sub_mail_to").val(b)})},initRegStep3:function(b){var d=["pharmacy"],f=["hosp_pharmacy"],e=["government","newspaper","other_company"],g=["pharmacy_chain","it_software"],h=["others"];a(".job-item").click(function(){var b=a(this).val();a("#require_department").val("0");
            -1<a.inArray(b,d)?(a("#type_name").html(c.__("phar_name")),a("#type_phone").html(c.__("phar_phone")),a("#section_work_at_home").hide(),a("#section_work_at_home input").attr("disabled","disabled"),a("#wrap_form_info").show(),a("#section_department").hide(),a("#sale_area").val(""),a(".department").removeAttr("checked"),a(".sale-area-section").hide(),a('#form_reg_step_3 input[type="text"]').removeAttr("disabled"),a("#title_input input").attr("disabled","disabled"),a("#title_radio input").removeAttr("disabled"),
                a("#title_input").hide(),a("#title_radio").show()):-1<a.inArray(b,f)?(a("#type_name").html(c.__("hosp_name")),a("#type_phone").html(c.__("hosp_phone")),a("#section_work_at_home").hide(),a("#section_work_at_home input").attr("disabled","disabled"),a("#wrap_form_info").show(),a("#section_department").hide(),a("#sale_area").val(""),a(".department").removeAttr("checked"),a(".sale-area-section").hide(),a('#form_reg_step_3 input[type="text"]').removeAttr("disabled"),a("#title_input input").attr("disabled",
                "disabled"),a("#title_radio input").removeAttr("disabled"),a("#title_input").hide(),a("#title_radio").show()):-1<a.inArray(b,e)?(a("#type_name").html(c.__("com_name")),a("#type_phone").html(c.__("com_phone")),a("#section_work_at_home").hide(),a("#section_work_at_home input").attr("disabled","disabled"),a("#wrap_form_info").show(),a("#section_department").hide(),a("#sale_area").val(""),a(".department").removeAttr("checked"),a(".sale-area-section").hide(),a('#form_reg_step_3 input[type="text"]').removeAttr("disabled"),
                a("#title_radio input").attr("disabled","disabled"),a("#title_input input").removeAttr("disabled"),a("#title_input").show(),a("#title_radio").hide()):-1<a.inArray(b,h)?(a("#type_name").html(c.__("com_name")),a("#type_phone").html(c.__("com_phone")),a("#section_work_at_home").show(),a("#section_work_at_home input").removeAttr("disabled"),a("#section_department").hide(),a("#sale_area").val(""),a(".department").removeAttr("checked"),a(".sale-area-section").hide(),a("#wrap_form_info").hide(),a("#title_radio input").attr("disabled",
                "disabled"),a("#title_input input").removeAttr("disabled"),a("#title_input").show(),a("#title_radio").hide(),a("#work_at_home").is(":checked")&&(a('#wrap_form_info input[type="text"]').val(""),a('#wrap_form_info input[type="text"]').attr("disabled","disabled"))):(a("#type_name").html(c.__("com_name")),a("#type_phone").html(c.__("com_phone")),a("#section_work_at_home").hide(),a("#wrap_form_info").show(),a("#section_department").show(),a("#require_department").val("1"),a(".department").removeAttr("checked"),
                a('#form_reg_step_3 input[type="text"]').removeAttr("disabled"),a("#title_radio input").attr("disabled","disabled"),a("#title_input input").removeAttr("disabled"),a("#title_input").show(),a("#title_radio").hide(),-1<a.inArray(b,g)&&(a("#sale_area").val(""),a("#sale_area").tokenInput("clear"),a(".sale-area-section").hide()))});a(".com-phone").keyup(function(){a(this).val().length==a(this).attr("maxLength")&&a(this).next("input").focus()});a(".job-interest").change(function(){a("#job_interest_text").val("")});
            a("#btn_submit_step_3").unbind("click");a("#btn_submit_step_3").click(function(){a("#btn_submit_step_3").spin("small");var c=0;a(".com-phone").each(function(){0==c&&a("#temp_phone").val("");3>c&&a("#temp_phone").val(a("#temp_phone").val()+a(this).val());c++});a.post(mooConfig.url.base+"/users/save_step_3/",a("#form_reg_step_3").serialize(),function(c){c=a.parseJSON(c);1==c.result?"profile"==b?location.reload():window.location=mooConfig.url.base+"/users/step_4":(a(".error-message").show(),a(".error-message").html(c.message));
                a("#btn_submit_step_3").spin(!1)})});a("#btn_find_phone").unbind("click");a("#btn_find_phone").click(function(){a("#btn_find_phone").spin("small");var b="",c=0;a(".com-phone").each(function(){3>c&&(b+=a(this).val());2>c&&(b+="-");c++});a.post(mooConfig.url.base+"/users/find_by_phone/",{phone:b},function(b){a("#btn_find_phone").spin(!1);b=a.parseJSON(b);1==b.result?(a("#com_name").val(b.name),a("#com_address_1").val(b.addr_1),a("#com_address_2").val(b.addr_2),a("#com_fax").val(b.fax),a("#com_zip").val(b.zip)):
                a("#com_name").focus()})});a(".department").on("click",function(){"sales"==a(this).val()&&0>a.inArray(a(".job-item:checked").val(),g)?a(".sale-area-section").show():a(".sale-area-section").hide()});a(document).ready(function(){var b=a("#prepopulate").val();b&&(b=a.parseJSON(b),a("#sale_area").tokenInput(mooConfig.url.base+"/users/search_sale_area",{preventDuplicates:!0,hintText:"",noResultsText:c.__("no_results"),resultsFormatter:function(a){return"<li>"+a.name+"</li>"},prePopulate:b,onAdd:function(a){},
                onDelete:function(){}}))});a("#work_at_home").click(function(){a("#work_at_home").is(":checked")?(a('#wrap_form_info input[type="text"]').val(""),a('#wrap_form_info input[type="text"]').attr("disabled","disabled")):a('#wrap_form_info input[type="text"]').removeAttr("disabled")});a("#work_at_home").is(":checked")&&(a('#wrap_form_info input[type="text"]').val(""),a('#wrap_form_info input[type="text"]').attr("disabled","disabled"));a("#com_zip").keyup(function(b){b=a(this).val();""!=b&&a.post(mooConfig.url.base+
                "/users/zip_suggestion",{searchVal:b},function(b){a("#zipcode-suggestion").html(b).show()})});a("#zipcode-suggestion").on("click","li",function(){a("#com_zip").val(a(this).html())});a("body").click(function(){a("#zipcode-suggestion").hide()})}}});