(function(b){"function"===typeof define&&define.amd?define(["jquery","mooPhrase"],b):"undefined"!==typeof exports?module.exports=b(require("jquery")):root.mooSimpleModal=b()})(function(b,f){var c=null;b.fn.extend({buttons:null,options:null,defaults:{onAppend:null,offsetTop:null,overlayOpacity:.3,overlayColor:"#000000",width:400,draggable:!0,keyEsc:!0,overlayClick:!1,closeButton:!0,hideHeader:!1,hideFooter:!0,btn_ok:f.__("btn_ok"),btn_cancel:f.__("btn_cancel"),template:'<div class="simple-modal-header title-modal">                 {_TITLE_}             </div>                 <div class="simple-modal-body modal-body">                 <div class="contents" id="simple-modal-body">{_CONTENTS_}</div>             </div>                 <div class="simple-modal-footer"></div>'},
    SimpleModal:function(a){c=this;this.buttons=[];this.options=b.extend({},c.defaults,a);return this},showModal:function(){var a=null;switch(this.options.model){case "modal-ajax":a=this._drawWindow(this.options);this._loadContents({url:c.options.param.url||"",onRequestComplete:this.options.param.onRequestComplete});break;case "confirm":this.addButton(this.options.btn_ok,"btn btn-action",function(){c.options.callback();c.hideModal()});this.addButton(this.options.btn_cancel,"button button-action");a=this._drawWindow(this.options);
        break;case "modal":this.addButton(this.options.btn_ok,"btn btn-action",function(){c.hideModal()});a=this._drawWindow(this.options);break;case "content":a=this._drawWindow(this.options);break;default:"undefined"!=typeof this.options.reload?this.addButton(this.options.btn_ok,"button button-action primary",function(){location.reload()}):this.addButton(this.options.btn_ok,"button button-action primary"),a=this._drawWindow(this.options)}a&&this._display()},hideModal:function(){c._overlay("hide");b(".modal-backdrop").remove();
        b("#simpleModal").remove()},_drawWindow:function(a){var d=b("<div>").addClass("simple-modal modal-dialog").attr("id","simple-modal");d.html(b("<div>").addClass("modal-content").html(this._template(c.options.template,{_TITLE_:a.title||"Untitled",_CONTENTS_:a.contents||""})));d=b("<div>").addClass("modal fade in").attr("id","simpleModal").attr("aria-hidden",!1).attr("aria-labelledby","myModalLabel").attr("role","basic").css({display:"block"}).html(d);b("body").append(d);b("body").append('<div class="modal-backdrop fade in"></div>');
        this._injectAllButtons();this.options.onAppend&&this.options.onAppend.call(this);return d},addButton:function(a,d,e){a=b("<a>").attr({title:a,"class":d}).click(e?function(a){e.call(c,a)}:c.hideModal).text(a);this.buttons.push(a);return this},_injectAllButtons:function(){var a=b("#simple-modal").find(".simple-modal-footer");b.each(c.buttons,function(b,c){a.append(c)})},_addCloseButton:function(){var a=b("<a>").addClass("close").attr({href:"#"}).html('<i class="material-icons">clear</i>').click(function(a){c.hideModal();
        return!1});b("#simple-modal").append(a);return a},_overlay:function(a){switch(a){case "show":a=b("<div>").attr("id","simple-modal-overlay").css({"background-color":this.options.overlayColor,opacity:0});b("body").append(a);a.animate({opacity:this.options.overlayOpacity});this.options.overlayClick&&a.click(function(a){c.hideModal()});b(window).resize(c._display);b(document).keyup(c._escape);break;case "hide":b("#simple-modal-overlay").remove(),b("#simple-modal").remove(),b(window).unbind("resize",c._display),
        b(document).unbind("keyup",c._escape)}},_escape:function(a){27==a.keyCode&&c.hideModal()},_loadContents:function(a){b("#simple-modal-body").spin("small");var d=new RegExp(/([^\/\\]+)\.(jpg|png|gif)$/i),e=b("#simple-modal");if(a.url.match(d)){e.addClass("hide-footer");b("#simple-modal-overlay").unbind();var f=b("<img>").attr("src",a.url).load(function(){var a=e.find(".contents").empty().append(b(this).css("opacity",0)),c=e.width()-a.width();a=e.height()-a.height();c=b(this).width()+c;a=b(this).height()+
        a;e.animate({width:c,height:a,left:(b(window).width()-c)/2,top:(b(window).height()-a)/2},200,function(){f.animate({opacity:1})})})}else b("#simple-modal .contents").load(a.url,function(d,e,f){d=b("#simple-modal");if("success"!==e){if(d.find(".contents").html("loading failed"),a.onRequestFailure)a.onRequestFailure()}else{if(a.onRequestComplete)a.onRequestComplete();c._display()}})},_display:function(){b("#simple-modal-overlay").css({width:b(window).width(),height:b(window).height()});var a=b("#simple-modal");
        c.options.offsetTop||(b(window).height(),a.height())},_template:function(a,b){for(var c in b)a=a.replace(new RegExp("{"+c+"}","g"),b[c]);return a}})});