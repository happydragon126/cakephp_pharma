(function(a,c){"function"===typeof define&&define.amd?define("jquery mooPhrase mooFileUploader mooAlert mooGlobal mooButton mooOverlay mooBehavior mooAjax spinner tipsy multiselect Jcrop bootstrap".split(" "),c):"object"===typeof exports?module.exports=c(require("jquery")):a.mooUser=c()})(this,function(a,c,t,f,u,v,g,h,w){var l=function(){a(".usernote-leave-note").on("click",function(){var b=a(this).closest(".usernote-widget");b.find(".usernotes .usernote-content").removeAttr("readonly").focus();b.find(".usernotes .usernote-content").css("pointer-events",
"auto");b.find(".usernote-action").show()});a(".usernote-cancel").off().on("click",function(){var b=a(this).closest(".usernote-widget");b.find(".usernotes .usernote-content").prop("readonly",!0);b.find(".usernotes .usernote-content").css("pointer-events","none");b.find(".usernote-action").hide();b.find(".usernote-content").val(b.find(".usernote-text-hidden").val());b.find(".unoteErrorMessage").hide()});a(".usernote-save").off().on("click",function(){var b=mooConfig.url.base+"/usernotes/usernotess/save_note",
c=a(this).closest(".usernote-widget"),d=c.find(".usernote-content").val(),e=a(".usernote-target-id").val();e={content:d,target_id:e};a(".usernotes").spin();a.post(b,e,function(b){a(".usernotes .spinner").remove();b=JSON.parse(b);if(0==b.result)return c.find(".unoteErrorMessage").show(),c.find(".unoteErrorMessage").html(b.message),!1;c.find(".unoteErrorMessage").hide();a(".usernote-content").val(d);a(".usernote-action").hide();c.find(".usernotes .usernote-content").prop("readonly",!0);c.find(".usernotes .usernote-content").css("pointer-events",
"none");jQuery(".usernote-widget .usernote-text-hidden").val(d);jQuery(".usernote-widget .usernote-remove").show()})});a(".usernote-remove").off().on("click",function(){a.fn.SimpleModal({btn_ok:c.__("ok"),btn_cancel:c.__("cancel"),callback:function(){var b=a(".usernote-target-id").val();a.post(mooConfig.url.base+"/usernotess/ajax_remove_note",{target_id:b},function(){a(".usernote-widget .usernote-content").val("")});jQuery(".usernote-widget .usernote-text-hidden").val("");jQuery(".usernote-widget .usernote-remove").hide();
jQuery(".usernote-widget .unoteErrorMessage").hide()},title:c.__("confirm"),contents:c.__("are_you_sure_you_want_to_remove_note"),model:"confirm",hideFooter:!1,closeButton:!1}).showModal()})},m=function(){a(".changeAdmin").unbind("click");a(".changeAdmin").on("click",function(){var b=a(this).data();changeAdmin(b.id,b.type)})},n=function(){a(".removeMember").unbind("click");a(".removeMember").on("click",function(){var b=a(this).data();removeMember(b.id)})},p=function(){a(".respondRequest").unbind("click");
a(".respondRequest").on("click",function(){var b=a(this).data();respondRequest(b.id,b.status)});a(".user_action_follow").unbind("click");a(".user_action_follow").click(function(){element=a(this);a.ajax({type:"POST",url:mooConfig.url.base+"/follows/ajax_update_follow",data:{user_id:a(this).data("uid")},success:function(a){element.data("follow")?(element.data("follow",0),element.find(".hidden-xs").html(c.__("text_follow")),element.find(".visible-xs").html("rss_feed")):(element.data("follow",1),element.find(".hidden-xs").html(c.__("text_unfollow")),
element.find(".visible-xs").html("check"))}})})},q=function(){a(".unote-delete-mobile").on("click",function(){var b=a(this).data();b=mooConfig.url.base+"/usernotess/remove_note/"+b.id+"/"+b.action;f.confirm(c.__("usn_please_confirm_remove_this_note"),b)})},r=function(){a(".unote-delete").unbind("click");a(".unote-edit").unbind("click");a("#unote-btn-save").unbind("click");a(".unote-delete").on("click",function(){var b=a(this).closest("li.user-list-index");a(this).data();a.fn.SimpleModal({btn_ok:c.__("usn_ok"),
btn_cancel:c.__("usn_cancel"),callback:function(){b.remove();var c=b.find(".unote-target-id").val();a.post(mooConfig.url.base+"/usernotess/ajax_remove_note",{target_id:c},function(){})},model:"confirm",title:c.__("usn_please_confirm"),contents:c.__("usn_please_confirm_remove_this_note"),hideFooter:!1,closeButton:!1}).showModal()});a(".unote_delete_app").unbind("click");a(".unote_delete_app").click(function(b){b=a(this).data();var k=mooConfig.url.base+"/usernotess/remove_note/"+b.id;a(this).closest("li.user-list-index");
a.fn.SimpleModal({btn_ok:c.__("usn_ok"),btn_cancel:c.__("usn_cancel"),callback:function(){a("#portlet-config").modal("hide");window.location=k},model:"confirm",title:c.__("usn_please_confirm"),contents:c.__("usn_please_confirm_remove_this_note"),hideFooter:!1,closeButton:!1}).showModal()});a(".unote-edit").on("click",function(){var b=c=a(this).closest("li.user-list-index").find(".detail-note textarea").val();a("#unoteModal .unoteErrorMessage").hide();a("#unoteModal .modal-body #unote-content").val(b);
a("#unoteModal .autogrow-textarea-mirror").html(b);a("#unoteModal").show();a("#unoteModal").modal("show");var c=c.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />")+".<br/>.";console.log(c);b=a("#unoteModal .autogrow-textarea-mirror").html(c).height();a("#unoteModal #unote-content").height(b);b=a(this).closest("li.user-list-index").find(".unote-target-id").val();a("#unoteModal .unote-target-id").val(b)});a("#unote-btn-save").on("click",
function(){var b=a("#unoteModal textarea#unote-content").val(),c=a("#unoteModal .unote-target-id").val();a.post(mooConfig.url.base+"/usernotess/save_note",{content:b,target_id:c},function(b){b=JSON.parse(b);if(0==b.result)return a(".unoteErrorMessage").show(),a(".unoteErrorMessage").html(b.message),!1;a(".unote-item-"+c+" .detail-note textarea").val(b.content);a(".unote-item-"+c+" .detail-note .note_content").html(b.content);a("#unoteModal").modal("hide")})})};return{initOnUserIndex:function(){a(".multi").multiSelect({selectAll:!1,
noneSelected:"",oneOrMoreSelected:c.__("per_selected")});a("#searchPeople").unbind("click");a("#searchPeople").click(function(){a("#everyone a").spin("tiny");a("#browse .current").removeClass("current");a("#everyone").addClass("current");a.post(mooConfig.url.base+"/usernotess/ajax_browse/search",a("#filters").serialize(),function(b){a("#everyone a").spin(!1);a("#list-content").html(b);g.registerOverlay()});992>a(window).width()&&(a("#leftnav").modal("hide"),a("body").scrollTop(0))})},initOnUserList:function(){a("#list-content li").hover(function(){a(this).contents().find(".delete-icon").show()},
function(){a(this).contents().find(".delete-icon").hide()});p();n();m();r();q();l();h.initMoreResults()}}});