(function(a,g){"function"===typeof define&&define.amd?define("jquery mooBehavior mooFileUploader mooAjax mooOverlay mooAlert mooPhrase mooGlobal tinyMCE mooUser mooButton".split(" "),g):"object"===typeof exports?module.exports=g(require("jquery")):a.mooClassified=g()})(this,function(a,g,l,A,p,k,c,m,e,B,n){var q=function(){e.remove("textarea#editor");e.init({selector:"textarea#editor",language:mooConfig.tinyMCE_language,theme:"modern",skin:"light",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table  directionality emoticons template paste textcolor"],
toolbar1:"styleselect | bold italic | bullist numlist outdent indent | forecolor backcolor emoticons | link unlink anchor image media | preview fullscreen code",image_advtab:!0,directionality:"ltr",width:'100%',menubar:!1,forced_root_block:"div",relative_urls:!1,remove_script_host:!0,document_base_url:mooConfig.url.base,browser_spellcheck:!0,contextmenu:!1});var b=new l.fineUploader({element:a("#attachments_upload")[0],autoUpload:!1,text:{uploadButton:'<div class="upload-section"><i class="material-icons">attach_file</i>'+
c.__("upload_button_text")+" </div>"},validation:{allowedExtensions:mooConfig.attachmentExt,sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+"/feedbacks/attachments/"+a("#plugin_feedback_id").val()},callbacks:{onError:m.errorHandler,onComplete:function(b,f,d){f=a("#attachments").val();d.attachment_id?(e.activeEditor.insertContent('<p><a href="'+mooConfig.url.base+"/attachments/download/"+d.attachment_id+'" class="attached-file">'+d.original_filename+"</a></p><br>"),""==f?a("#attachments").val(d.attachment_id):
a("#attachments").val(f+","+d.attachment_id)):(b||d.thumb)&&e.activeEditor.insertContent('<p align="center"><a href="'+d.large+'" class="attached-image"><img src="'+d.thumb+'" width="100%"></a></p><br>')}}});a("#triggerUpload1").unbind("click");a("#triggerUpload1").click(function(){b.uploadStoredFiles()});a("#toggleUploader").unbind("click");a("#toggleUploader").on("click",function(){a("#images-uploader1").slideToggle()});jQuery.feedback.initFeedbackUploader();jQuery.feedback.initFeedbackImage()},
r=function(){e.remove("textarea#editor");e.init({selector:"textarea#editor",language:mooConfig.tinyMCE_language,theme:"modern",skin:"light",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table  directionality emoticons template paste textcolor"],toolbar1:"styleselect | bold italic | bullist numlist outdent indent | forecolor backcolor emoticons | link unlink anchor image media | preview fullscreen code",
image_advtab:!0,directionality:"ltr",width:'100%',menubar:!1,forced_root_block:"div",relative_urls:!1,remove_script_host:!0,document_base_url:mooConfig.url.base,browser_spellcheck:!0,contextmenu:!1});var b=new l.fineUploader({element:a("#attachments_upload")[0],autoUpload:!1,text:{uploadButton:'<div class="upload-section"><i class="material-icons">attach_file</i>'+c.__("upload_button_text")+" </div>"},validation:{allowedExtensions:mooConfig.attachmentExt,sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+
"/feedbacks/attachments/"+a("#plugin_feedback_id").val()},callbacks:{onError:m.errorHandler,onComplete:function(b,f,d){f=a("#attachments").val();d.attachment_id?(e.activeEditor.insertContent('<p><a href="'+mooConfig.url.base+"/attachments/download/"+d.attachment_id+'" class="attached-file">'+d.original_filename+"</a></p><br>"),""==f?a("#attachments").val(d.attachment_id):a("#attachments").val(f+","+d.attachment_id)):(b||d.thumb)&&e.activeEditor.insertContent('<p align="center"><a href="'+d.large+
'" class="attached-image"><img src="'+d.thumb+'" width="100%"></a></p><br>')}}});a("#triggerUpload1").unbind("click");a("#triggerUpload1").click(function(){b.uploadStoredFiles()});a("#toggleUploader").unbind("click");a("#toggleUploader").on("click",function(){a("#images-uploader1").slideToggle()});jQuery.feedback.initFeedbackUploader()},t=function(){a(".fb_vote").unbind("click");a(".fb_vote").click(function(){var b=a(this).attr("ref");jQuery.feedback.vote(b,a(this))})},x=function(){p.registerImageOverlay();
a(".fb_approve").unbind("click");a(".fb_approve").click(function(){a(this).attr("ref")});u();v();w();a(".fb_vote").unbind("click");a(".fb_vote").click(function(){var b=a(this).attr("ref");jQuery.feedback.vote(b,a(this))})},y=function(){jQuery(window).load(function(){console.log('load');jQuery.post(mooConfig.url.base+"/feedbacks/popups/load_shortcut","",function(a){jQuery("body").append(a);jQuery.feedback.initFeedbackUploader();jQuery.feedback.initFeedbackImage()})})};jQuery.feedback={vote:function(a,h){h.addClass("disabled");
jQuery.post(mooConfig.url.base+"/feedbacks/feedbackvotes/ajax_add/"+a,function(a){a=jQuery.parseJSON(a);0==a.result?k.alert(a.message):(jQuery("."+a.feedback).html(parseInt(a.total_votes)),jQuery("."+a.feedback).parent().find("span").empty().append(a.text),jQuery(".a_"+a.feedback).html(a.action));h.removeClass("disabled")})},initFeedbackUploader:function(b){b=function(b,h,e,g){0<a("#attachments_upload .qq-upload-list .errorUploadMsg").length?a("#attachments_upload .qq-upload-list .errorUploadMsg").html(c.__("tmaxsize")):
a("#attachments_upload .qq-upload-list").prepend('<div class="errorUploadMsg">'+c.__("tmaxsize")+"</div>");a("#attachments_upload .qq-upload-fail").remove()};if(0<a("#uploader").length){var h=new l.fineUploader({element:a("#uploader")[0],autoUpload:!1,text:{uploadButton:'<div class="upload-section"><i class="icon-camera"></i>'+c.__("tdesc")+"</div>"},validation:{allowedExtensions:["jpg","jpeg","gif","png"]},request:{endpoint:mooConfig.url.base+"/feedbacks/upload/"},callbacks:{onError:b,onComplete:function(b,
h,c){b=a("#FeedbackAttachments").val();c.feedback_image_id?""==b?a("#FeedbackAttachments").val(c.feedback_image_id):a("#FeedbackAttachments").val(b+","+c.feedback_image_id):0==c.result&&k.alert(c.message)}}});a("#triggerUpload").unbind("click");a("#triggerUpload").click(function(){h.uploadStoredFiles()})}},createFeedback:function(b){null!==e.activeEditor&&a("#editor").val(e.activeEditor.getContent());n.disableButton("createButton");jQuery.post(mooConfig.url.base+"/feedbacks/feedbacks/ajax_save",jQuery("#createForm").serialize(),
function(b){n.enableButton("createButton");b=a.parseJSON(b);1==b.result?b.url?window.location=mooConfig.isApp?b.url+"?app_no_tab=1":b.url:(a("#add").attr("href",a("#add").attr("href")+b.id),jQuery.post(mooConfig.url.base+"/feedbacks/feedbacks/ajax_thanks/","id="+b.id+"&approved="+b.approved,function(a){jQuery("#themeModal .modal-content").empty().append(a)})):(a(".error-message").show(),a(".error-message").html(b.message),0<a(".spinner").length&&a(".spinner").remove(),0<jQuery("#captcha").length&&
grecaptcha.reset())})},initFeedbackImage:function(){jQuery(".attach_remove").each(function(){var b=a("#FeedbackAttachments").val();""==b?a("#FeedbackAttachments").val(jQuery(this).data("id")):a("#FeedbackAttachments").val(b+","+jQuery(this).data("id"))})},removeFeedbackImage:function(a){a=a.toString();jQuery("#attach"+a).remove();var b=jQuery("#FeedbackAttachments").val().split(",");a=b.indexOf(a);-1<a&&b.splice(a,1);jQuery("#FeedbackAttachments").val(b.join())}};var u=function(){a(".fb_approve").unbind("click");
a(".fb_approve").click(function(){var b=a(this).data();mooConfig.isApp?a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),callback:function(){a.post(mooConfig.url.base+"/feedbacks/do_active/"+b.id+"/approved/"+b.status,function(){window.location.reload()})},title:c.__("please_confirm"),contents:b.confirm,model:"confirm",hideFooter:!1,closeButton:!1}).showModal():k.confirm(b.confirm,mooConfig.url.base+"/feedbacks/do_active/"+b.id+"/approved/"+b.status)})},v=function(){a(".fb_feature").unbind("click");
a(".fb_feature").click(function(){var b=a(this).data();mooConfig.isApp?a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),callback:function(){a.post(mooConfig.url.base+"/feedbacks/do_active/"+b.id+"/featured/"+b.status,function(){window.location.reload()})},title:c.__("please_confirm"),contents:b.confirm,model:"confirm",hideFooter:!1,closeButton:!1}).showModal():k.confirm(b.confirm,mooConfig.url.base+"/feedbacks/do_active/"+b.id+"/featured/"+b.status)})},w=function(){a(".fb_delete").unbind("click");
a(".fb_delete").click(function(){var b=a(this).data();k.confirm(b.confirm,mooConfig.isApp?mooConfig.url.base+"/feedbacks/delete/"+b.id+"?app_no_tab=1":mooConfig.url.base+"/feedbacks/delete/"+b.id)})},z=function(){a(".fb_vote").unbind("click");a(".fb_vote").click(function(){var b=a(this).attr("ref");jQuery.feedback.vote(b,a(this))});g.initMoreResults()};return{initOnCreate:function(){q()},initOnIndex:function(){t()},initOnView:function(){x()},initShortcut:function(){y()},initOnLoadMore:function(){z()},
initOnCreateInApp:function(){r()}}});