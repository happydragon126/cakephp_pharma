/*
 @copyright &copy; Kartik Visweswaran, Krajee.com, 2014
 @version 3.3.0

 A simple yet powerful JQuery star rating plugin that allows rendering
 fractional star ratings and supports Right to Left (RTL) input.

 For more JQuery plugins visit http://plugins.krajee.com
 For more Yii related demos visit http://demos.krajee.com
*/
(function(f){"function"===typeof define&&define.amd?define(["jquery"],f):f(jQuery)})(function(f){var k="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,d=function(a,b){return"undefined"===typeof a||null===a||void 0===a||a==[]||""===a||b&&""===f.trim(a)},g=function(a,b,c){return(a=d(a.data(b))?a.attr(b):a.data(b))?a:c[b]},h=function(a,b){this.$element=f(a);this.init(b)};h.prototype={constructor:h,_parseAttr:function(a,b){var c=this.$element;if("range"===c.attr("type")||
"number"===c.attr("type")){c=g(c,a,b);var e=.5;"min"===a?e=0:"max"===a?e=5:"step"===a&&(e=.5);c=d(c)?e:c;return parseFloat(c)}return parseFloat(b[a])},listen:function(){var a=this;a.initTouch();a.$rating.on("click",function(b){a.inactive||(b=b.pageX-a.$rating.offset().left,a.setStars(b),a.$element.trigger("change"),a.$element.trigger("rating.change",[a.$element.val(),a.$caption.html()]),a.starClicked=!0,a.$element.closest(".review_star").children(".review_point")[0].value=a.$element.val())});a.$rating.on("mousemove",
function(b){a.hoverEnabled&&!a.inactive&&(a.starClicked=!1,b=b.pageX-a.$rating.offset().left,b=a.calculate(b),a.toggleHover(b),a.$element.trigger("rating.hover",[b.val,b.caption,"stars"]))});a.$rating.on("mouseleave",function(b){!a.hoverEnabled||a.inactive||a.starClicked||(a.toggleHover(a.cache),a.$element.trigger("rating.hoverleave",["stars"]))});a.$clear.on("mousemove",function(b){if(a.hoverEnabled&&!a.inactive&&a.hoverOnClear){a.clearClicked=!1;b='<span class="'+a.clearCaptionClass+'">'+a.clearCaption+
"</span>";var c=a.clearValue,e=a.getWidthFromValue(c);a.toggleHover({caption:b,width:e,val:c});a.$element.trigger("rating.hover",[c,b,"clear"])}});a.$clear.on("mouseleave",function(b){a.hoverEnabled&&!a.inactive&&!a.clearClicked&&a.hoverOnClear&&(a.toggleHover(a.cache),a.$element.trigger("rating.hoverleave",["clear"]))});a.$clear.on("click",function(b){a.inactive||(a.clear(),a.clearClicked=!0)});f(a.$element[0].form).on("reset",function(b){a.inactive||a.reset()})},destroy:function(){var a=this.$element;
d(this.$container)||this.$container.before(a).remove();f.removeData(a.get(0));a.off("rating").removeClass("hide")},create:function(){var a=0<arguments.length?arguments[0]:{},b=self.$element;self.destroy();b.rating(a)},setTouch:function(a,b){if(k&&!this.inactive){var c=a.originalEvent;c=(0<c.touches.length?c.touches:c.changedTouches)[0].pageX-this.$rating.offset().left;if(!0===b)this.setStars(c),this.$element.trigger("change"),this.$element.trigger("rating.change",[this.$element.val(),this.$caption.html()]),
this.starClicked=!0;else{var e=this.calculate(c);c=e.val<=this.clearValue?this.fetchCaption(this.clearValue):e.caption;var d=this.getWidthFromValue(this.clearValue);e=e.val<=this.clearValue?this.rtl?100-d+"%":d+"%":e.width;this.$caption.html(c);this.$stars.css("width",e)}}},initTouch:function(){var a=this;a.$rating.on("touchstart",function(b){a.setTouch(b,!1)});a.$rating.on("touchmove",function(b){a.setTouch(b,!1)});a.$rating.on("touchend",function(b){a.setTouch(b,!0)})},initSlider:function(a){d(this.$element.val())&&
this.$element.val(0);this.initialValue=this.$element.val();this.min="undefined"!==typeof a.min?a.min:this._parseAttr("min",a);this.max="undefined"!==typeof a.max?a.max:this._parseAttr("max",a);this.step="undefined"!==typeof a.step?a.step:this._parseAttr("step",a);if(isNaN(this.min)||d(this.min))this.min=0;if(isNaN(this.max)||d(this.max))this.max=5;if(isNaN(this.step)||d(this.step)||0==this.step)this.step=.5;this.diff=this.max-this.min},init:function(a){this.options=a;this.hoverEnabled=a.hoverEnabled;
this.hoverChangeCaption=a.hoverChangeCaption;this.hoverChangeStars=a.hoverChangeStars;this.hoverOnClear=a.hoverOnClear;this.clearClicked=this.starClicked=!1;this.initSlider(a);this.checkDisabled();$element=this.$element;this.containerClass=a.containerClass;var b=(this.glyphicon=a.glyphicon)?"\ue006":"\u2605";this.symbol=d(a.symbol)?b:a.symbol;(this.rtl=a.rtl||this.$element.attr("dir"))&&this.$element.attr("dir","rtl");this.showClear=a.showClear;this.showCaption=a.showCaption;this.size=a.size;this.stars=
a.stars;this.defaultCaption=a.defaultCaption;this.starCaptions=a.starCaptions;this.starCaptionClasses=a.starCaptionClasses;this.clearButton=a.clearButton;this.clearButtonTitle=a.clearButtonTitle;this.clearButtonBaseClass=d(a.clearButtonBaseClass)?"clear-rating":a.clearButtonBaseClass;this.clearButtonActiveClass=d(a.clearButtonActiveClass)?"clear-rating-active":a.clearButtonActiveClass;this.clearCaption=a.clearCaption;this.clearCaptionClass=a.clearCaptionClass;this.clearValue=d(a.clearValue)?this.min:
a.clearValue;this.$element.removeClass("form-control").addClass("form-control");this.$clearElement=d(a.clearElement)?null:f(a.clearElement);this.$captionElement=d(a.captionElement)?null:f(a.captionElement);"undefined"==typeof this.$rating&&"undefined"==typeof this.$container&&(this.$rating=f(document.createElement("div")).html('<div class="rating-stars"></div>'),this.$container=f(document.createElement("div")),this.$container.before(this.$rating),this.$container.append(this.$rating),this.$element.before(this.$container).appendTo(this.$rating));
this.$stars=this.$rating.find(".rating-stars");this.generateRating();this.$clear=d(this.$clearElement)?this.$container.find("."+this.clearButtonBaseClass):this.$clearElement;this.$caption=d(this.$captionElement)?this.$container.find(".caption"):this.$captionElement;this.setStars();this.$element.removeClass("hide").addClass("hide");this.listen();this.showClear&&this.$clear.attr({"class":this.getClearClass()});this.cache={caption:this.$caption.html(),width:this.$stars.width(),val:this.$element.val()};
this.$element.removeClass("rating-loading")},checkDisabled:function(){this.disabled=g(this.$element,"disabled",this.options);this.readonly=g(this.$element,"readonly",this.options);this.inactive=this.disabled||this.readonly},getClearClass:function(){return this.clearButtonBaseClass+" "+(this.inactive?"":this.clearButtonActiveClass)},generateRating:function(){var a=this.renderClear(),b=this.renderCaption(),c=this.rtl?"rating-container-rtl":"rating-container",e=this.getStars();c+=this.glyphicon?"\ue006"==
this.symbol?" rating-gly-star":" rating-gly":" rating-uni";this.$rating.attr("class",c);this.$rating.attr("data-content",e);this.$stars.attr("data-content",e);c=this.rtl?"star-rating-rtl":"star-rating";this.$container.attr("class",c+" rating-"+this.size);this.inactive?this.$container.removeClass("rating-active").addClass("rating-disabled"):this.$container.removeClass("rating-disabled").addClass("rating-active");"undefined"==typeof this.$caption&&"undefined"==typeof this.$clear&&(this.rtl?this.$container.prepend(b).append(a):
this.$container.prepend(a).append(b));d(this.containerClass)||this.$container.removeClass(this.containerClass).addClass(this.containerClass)},getStars:function(){for(var a=this.stars,b="",c=1;c<=a;c++)b+=this.symbol;return b},renderClear:function(){if(!this.showClear)return"";var a=this.getClearClass();return d(this.$clearElement)?'<div class="'+a+'" title="'+this.clearButtonTitle+'">'+this.clearButton+"</div>":(this.$clearElement.removeClass(a).addClass(a).attr({title:this.clearButtonTitle}),this.$clearElement.html(this.clearButton),
"")},renderCaption:function(){var a=this.$element.val();if(!this.showCaption)return"";a=this.fetchCaption(a);return d(this.$captionElement)?'<div class="caption">'+a+"</div>":(this.$captionElement.removeClass("caption").addClass("caption").attr({title:this.clearCaption}),this.$captionElement.html(a),"")},fetchCaption:function(a){a=parseFloat(a);var b="function"==typeof this.starCaptionClasses?d(this.starCaptionClasses(a))?this.clearCaptionClass:this.starCaptionClasses(a):d(this.starCaptionClasses[a])?
this.clearCaptionClass:this.starCaptionClasses[a];var c="function"==typeof this.starCaptions?d(this.starCaptions(a))?this.defaultCaption.replace(/\{rating\}/g,a):this.starCaptions(a):d(this.starCaptions[a])?this.defaultCaption.replace(/\{rating\}/g,a):this.starCaptions[a];return'<span class="'+b+'">'+(a==this.clearValue?this.clearCaption:c)+"</span>"},getWidthFromValue:function(a){var b=this.min,c=this.max;return a<=b||b==c?0:a>=c?100:100*(a-b)/(c-b)},getValueFromPosition:function(a){var b=(b=(""+
this.step).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(b[1]?b[1].length:0)-(b[2]?+b[2]:0)):0;var c=this.$rating.width();a=this.diff*a/(c*this.step);a=this.rtl?Math.floor(a):Math.ceil(a);a=parseFloat(this.min+a*this.step);b=parseFloat(a.toFixed(b));b=Math.max(Math.min(b,this.max),this.min);return this.rtl?this.max-b:b},toggleHover:function(a){if(this.hoverChangeCaption){var b=a.val<=this.clearValue?this.fetchCaption(this.clearValue):a.caption;this.$caption.html(b)}this.hoverChangeStars&&
(b=this.getWidthFromValue(this.clearValue),this.$stars.css("width",a.val<=this.clearValue?this.rtl?100-b+"%":b+"%":a.width))},calculate:function(a){var b=d(this.$element.val())?0:this.$element.val();b=arguments.length?this.getValueFromPosition(a):b;var c=this.fetchCaption(b),e=this.getWidthFromValue(b);this.rtl&&(e=100-e);return{caption:c,width:e+"%",val:b}},setStars:function(a){var b=arguments.length?this.calculate(a):this.calculate();this.$element.val(b.val);this.$stars.css("width",b.width);this.$caption.html(b.caption);
this.cache=b},clear:function(){var a='<span class="'+this.clearCaptionClass+'">'+this.clearCaption+"</span>";this.$stars.removeClass("rated");this.inactive||this.$caption.html(a);this.$element.val(this.clearValue);this.setStars();this.$element.trigger("rating.clear")},reset:function(){this.$element.val(this.initialValue);this.setStars();this.$element.trigger("rating.reset")},update:function(a){arguments.length&&(this.$element.val(a),this.setStars())},refresh:function(a){arguments.length&&(this.$rating.off("rating"),
this.$clear.off(),this.init(f.extend(this.options,a)),this.showClear?this.$clear.show():this.$clear.hide(),this.showCaption?this.$caption.show():this.$caption.hide(),this.$element.trigger("rating.refresh"))}};f.fn.rating=function(a){var b=Array.apply(null,arguments);b.shift();return this.each(function(){var c=f(this),d=c.data("rating"),g="object"===typeof a&&a;d||c.data("rating",d=new h(this,f.extend({},f.fn.rating.defaults,g,f(this).data())));"string"===typeof a&&d[a].apply(d,b)})};f.fn.rating.defaults=
{stars:5,glyphicon:!0,symbol:null,disabled:!1,readonly:!1,rtl:!1,size:"md",showClear:!0,showCaption:!0,defaultCaption:"{rating} Stars",starCaptions:{"0.5":"Half Star",1:"One Star","1.5":"One & Half Star",2:"Two Stars","2.5":"Two & Half Stars",3:"Three Stars","3.5":"Three & Half Stars",4:"Four Stars","4.5":"Four & Half Stars",5:"Five Stars"},starCaptionClasses:{"0.5":"label label-danger",1:"label label-danger","1.5":"label label-warning",2:"label label-warning","2.5":"label label-info",3:"label label-info",
"3.5":"label label-primary",4:"label label-primary","4.5":"label label-success",5:"label label-success"},clearButton:'<i class="glyphicon glyphicon-minus-sign"></i>',clearButtonTitle:"Clear",clearButtonBaseClass:"clear-rating",clearButtonActiveClass:"clear-rating-active",clearCaption:"Not Rated",clearCaptionClass:"label label-default",clearValue:null,captionElement:null,clearElement:null,containerClass:null,hoverEnabled:!0,hoverChangeCaption:!0,hoverChangeStars:!0,hoverOnClear:!0};f("input.rating").addClass("rating-loading")});