!function(e,t){"function"==typeof define&&define.amd?define(["jquery","mooAlert","mooPhrase"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.mooSticker=t()}(this,function(e,t,i){var o,a="Sticker",c="#stickerModal",n=3,r=0,s={commentForm:{selectStickerId:"sticker_item_comment_",buttonId:"#commentButton_",beforeCallback:"beforePostCommentCallback",afterCallback:"afterSubmitCommentCallbackSuccess"},commentReplyForm:{selectStickerId:"sticker_item_reply_",buttonId:"#commentReplyButton_",beforeCallback:"beforePostReplyCallback",afterCallback:"afterSubmitReplySuccessCallback"},activitycommentReplyForm:{selectStickerId:"sticker_item_activity_reply_",buttonId:"#activity_commentReplyButton_",beforeCallback:"beforePostReplyCallback",afterCallback:"afterSubmitReplySuccessCallback"},activity_comment_edit:{selectStickerId:"sticker_activity_comment_edit_",buttonId:"#activity_comment_preview_attach_",beforeCallback:"beforeEditCommentCallback",afterCallback:"afterEditCommentCallback"},item_commentReplyForm:{selectStickerId:"sticker_item_comment_reply_",buttonId:"#item_commentReplyButton_",beforeCallback:"beforePostReplyCallback",afterCallback:"afterSubmitReplySuccessCallback"},item_comment_edit:{selectStickerId:"sticker_item_comment_edit_",buttonId:"#item_comment_preview_attach_",beforeCallback:"beforeEditCommentCallback",afterCallback:"afterEditCommentCallback"},activity_edit:{selectStickerId:"sticker_activity_edit_",buttonId:"#activity_edit_",beforeCallback:"beforeEditActivityCallback",afterCallback:"afterEditActivityCallback"}};function l(){e(".sticker_animation").each(function(){0!=e(this).data("autoplayed")&&void 0!==e(this).data("autoplayed")||(e(this).data("autoplayed",1),d(e(this)))})}function m(t,i){if(void 0!==t&&void 0!==i&&""!=i){var o=s[i].selectStickerId+t,c=s[i].beforeCallback;e("#"+o).remove(),e("body").on(c,function(e,t){t.emptyContent=!1,t.targetId="",t.itemType="",t.params={}})}else e("#sticker_post_feed").remove(),e("#sticker_image_id").val("").attr("disabled","disbled"),e("body").on("beforePostWall",function(e,t){t.emptyContent=!1}),e("body").trigger("stopFeedPlugin3drCallback",[{plugin_name:a}]);e("#select-2").show(),e("#wall_photo_preview").hide(),e("#wall_photo").val(""),function(t,i){if("activity_edit"==t){var o=e("#activity_"+i);o.find(".sticker_activity_item").length>0?o.find(".photo_addlist").hide():o.find(".photo_addlist").show()}else if("commentForm"==t){var o=e("#newComment_"+i);0==i&&(o=e("#commentForm")),o.find("div[id*='comment_button_attach_']").show(),o.find(".gif_holder").show()}else if("commentReplyForm"==t){var o=e("#newComment_reply_"+i);o.find("div[id*='comment_reply_button_attach_']").show(),o.find(".gif_holder").show()}else if("activitycommentReplyForm"==t){var o=e("#activitynewComment_reply_"+i);o.find("div[id*='activitycomment_reply_button_attach_']").show(),o.find(".gif_holder").show()}else if("activity_comment_edit"==t){var o=e("#comment_"+i);o.find("div[id*='activity_comment_attach_']").show(),o.find(".gif_holder").show()}else if("item_commentReplyForm"==t){var o=e("#item_newComment_reply_"+i);o.find("div[id*='item_comment_reply_button_attach_']").show(),o.find(".gif_holder").show()}else if("item_comment_edit"==t){var o=e("#item_comment_edit_"+i);o.find("div[id*='item_comment_attach_']").show(),o.find(".gif_holder").show()}}(i,t)}function _(){f()}function d(e){if((1!=parseInt(e.data("block"))||1!=parseInt(e.data("quantity")))&&1!=e.data("playing")){var t=parseInt(e.data("interval")),i=e.css("backgroundPosition").split(" "),o=e.css("backgroundSize").split(" "),a=parseFloat(i[0]),c=parseFloat(i[1]),r=parseFloat(o[0]),s=parseFloat(o[1]),l=(r/parseInt(e.attr("data-block"))*100).toFixed(1);l=Math.ceil(l)/100;var m=parseInt(e.data("quantity"))-1,_=0,d=0,f=setInterval(function(){e.data("playing",1),_+=1,(a-=l)<=-r&&(a=0,c-=l),(c<-s||_>m)&&(_=0,a=0,c=0,d+=1),e.css("backgroundPosition",a+"px "+c+"px"),d>=n&&(clearInterval(f),e.data("playing",0))},t)}}function f(){var t=e("#sticker_search").val();if(!(""==t.trim()||t.length<2)){e(".sticker_category_container").hide(),e("#sticker_search_content").html(""),e("#sticker_search_content").spin("small");var i={keyword:t};e.get(mooConfig.url.base+"/sticker/search",i,function(t){e("#sticker_search_content").spin(!1),e("#sticker_search_content").html(t),e(".scrollbar-inner").scrollbar({height:300})})}}function h(t,i){if("activity_edit"==t)(o=e("#activity_"+i)).find(".photo_addlist").hide();else if("commentForm"==t){var o=e("#newComment_"+i);0==i&&(o=e("#commentForm")),o.find("div[id*='comment_preview_image_']").empty(),o.find("input[id*='comment_image_']").val(""),o.find("div[id*='comment_button_attach_']").hide(),o.find(".gif_holder").hide()}else if("commentReplyForm"==t){(o=e("#newComment_reply_"+i)).find("div[id*='comment_reply_preview_image_']").empty(),o.find("input[id*='comment_reply_image_']").val(""),o.find("div[id*='comment_reply_button_attach_']").hide(),o.find(".gif_holder").hide()}else if("activitycommentReplyForm"==t){(o=e("#activitynewComment_reply_"+i)).find("div[id*='activitycomment_reply_preview_image_']").empty(),o.find("input[id*='activitycomment_reply_image_']").val(""),o.find("div[id*='activitycomment_reply_button_attach_']").hide(),o.find(".gif_holder").hide()}else if("activity_comment_edit"==t){(o=e("#comment_"+i)).find("div[id*='activity_comment_preview_attach_']").empty(),o.find("input[id*='activity_comment_attach_id_']").val(""),o.find("div[id*='activity_comment_attach_']").hide(),o.find(".gif_holder").hide()}else if("item_commentReplyForm"==t){(o=e("#item_newComment_reply_"+i)).find("div[id*='item_comment_reply_preview_image_']").empty(),o.find("input[id*='item_comment_reply_image_']").val(""),o.find("div[id*='item_comment_reply_button_attach_']").hide(),o.find(".gif_holder").hide()}else if("item_comment_edit"==t){(o=e("#item_comment_edit_"+i)).find("div[id*='item_comment_preview_attach_']").empty(),o.find("input[id*='item_comment_attach_id_']").val(""),o.find("div[id*='item_comment_attach_']").hide(),o.find(".gif_holder").hide()}}return{initSticker:function(){l(),e(document).ajaxComplete(function(e,t,i){-1===i.url.indexOf(mooConfig.url.base+"/activities/browse")&&-1===i.url.indexOf(mooConfig.url.base+"/comments/browse")&&-1===i.url.indexOf(mooConfig.url.base+"/photos/view")||l()}),e(c).on("shown.bs.modal",function(){i.__("sticker_is_android")&&Android.disableRefresh()}),e(c).on("hidden.bs.modal",function(){!0===i.__("sticker_is_mobile")&&r>0&&(document.documentElement.scrollTop=document.body.scrollTop=r),e(c+" .modal-content").empty(),i.__("sticker_is_android")&&Android.enableRefresh()}),e(".sticker_button").each(function(){e(this).find("i").closest("#commentForm").length>0&&e(this).find("i").data("itemId",0)}),e(".stt-action, .comment_wrapper, #photoModal, #photo-content, #commentForm").off("click",".sticker_button i"),e(".stt-action, .comment_wrapper, #photoModal, #photo-content, #commentForm").on("click",".sticker_button i",function(){e(".sticker_button").hasClass("show-sticker")?function(t){r=document.documentElement.scrollTop||document.body.scrollTop,e(c).modal({backdrop:"static"});var i={item_type:void 0!==t.data("itemType")?t.data("itemType"):"",item_id:void 0!==t.data("itemId")?t.data("itemId"):0,photo_theater:void 0!==t.data("photoTheater")?t.data("photoTheater"):0};e.get(mooConfig.url.base+"/sticker/sticker_modal",i,function(t){e(c+" .modal-content").html(t),e(".sticker_list").slick({dots:!1,infinite:!1,speed:300,slidesToShow:4,slidesToScroll:4,variableWidth:!0,prevArrow:'<i class="material-icons sticker_slick-prev">keyboard_arrow_left</i>',nextArrow:'<i class="material-icons sticker_slick-next">keyboard_arrow_right</i>',responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:!0,dots:!0}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]}),e(".scrollbar-inner").scrollbar({height:300})})}(e(this)):(message=i.__("information"),msg=i.__("please_contact_any_sales_reps_visiting_you")+". <br><br>"+i.__("gif_msg_part2")+".<br>("+i.__("gif_msg_part3")+").<br>"+i.__("gif_msg_part4")+". <br><br><a href='/faqs/view/20/how-to-get-free-item-from-sales-member'>"+i.__("gif_msg_part5")+"</a>, "+i.__("or")+", <a href='javascript:void(0);'>"+i.__("gif_msg_part6")+"</a>",e(e("#portlet-config  .modal-header .modal-title")[0]).html(message),e(e("#portlet-config  .modal-body")[0]).html(msg),e("#portlet-config  .modal-footer .ok").off("click").click(function(){callback(),e("#portlet-config").modal("hide")}),e("#portlet-config .blue.ok").css("display","none"),e("#portlet-config").modal("show"))}),e(c).off("click",".sticker_item_sticker:not(.current)"),e(c).on("click",".sticker_item_sticker:not(.current)",function(){e(".sticker_item").removeClass("current"),e(this).addClass("current"),e("#sticker_images").html(""),e("#sticker_images").spin("small"),e.get(mooConfig.url.base+"/sticker/sticker_modal_images/"+e(this).data("id"),"",function(t){e("#sticker_images").spin(!1),e("#sticker_images").html(t),e(".scrollbar-inner").scrollbar({height:300})})}),e(c).on("click",".sticker_item_search:not(.current)",function(){e(".sticker_item").removeClass("current"),e(this).addClass("current"),e("#sticker_images").html(""),e("#sticker_images").spin("small"),e.get(mooConfig.url.base+"/sticker/sticker_modal_search/",function(t){e("#sticker_images").spin(!1),e("#sticker_images").html(t),e(".scrollbar-inner").scrollbar({height:300})})}),e(c).on("click",".sticker_item_recent:not(.current)",function(){e(".sticker_item").removeClass("current"),e(this).addClass("current"),e("#sticker_images").html(""),e("#sticker_images").spin("small"),e.get(mooConfig.url.base+"/sticker/sticker_modal_recent/",function(t){e("#sticker_images").spin(!1),e("#sticker_images").html(t),e(".scrollbar-inner").scrollbar({height:300})})}),e(document).on("mouseenter",".sticker_animation",function(t){d(e(this))}),e(c).off("click",".sticker_animation"),e(c).on("click",".sticker_animation",function(){var t=e("#stickerModal #sticker_item_type").val();m(e("#stickerModal #sticker_item_id").val(),t),function(t){var i=e("#stickerModal #sticker_item_type").val(),o=e("#stickerModal #sticker_item_id").val(),n=e("#stickerModal #sticker_photo_theater").val(),r="sticker_post_feed";""!=i&&(r=s[i].selectStickerId+o),e(t).css("backgroundPosition","0px 0px");var l='<div class="sticker_select" id="'+r+'"><div class="sticker_select_animation">'+t[0].outerHTML+'<div class="sticker_remove_select" data-item-type="'+i+'" data-item-id="'+o+'">x</div></div></div>';if(""!=i){var _=s[i].buttonId+o,d=s[i].beforeCallback;1==n&&"commentForm"==i?e("#photo-content").length>0?e("#photo-content").find("#commentButton_0").before(l):e("#photoModal").find("#commentButton_0").before(l):e(_).before(l),"activity_edit"==i&&e("#activity_"+o).find(".cancelEditActivity").click(function(){m(o,i)}),e("body").on(d,function(a,c){c.emptyContent=!0,c.targetId=o,c.itemType=i,c.params={sticker_image_id:e(t).data("id"),empty_comment:1}})}else e(".form-feed-holder").prepend(l),e("#sticker_image_id").val(t.data("id")).removeAttr("disabled"),e("body").on("beforePostWall",function(e,t){t.emptyContent=!0}),e("body").trigger("startFeedPlugin3drCallback",[{plugin_name:a}]),e(".userTagging-userShareLink #preview_link").remove(),e(".userTagging-userShareVideo #preview_link").remove(),e(".userTagging-userShareVideo #userShareVideo").val(""),e("#select-2").hide(),e("#wall_photo_preview").hide(),e("#wall_photo_preview").find("span").each(function(){"addMoreImage"!=e(this).attr("id")&&e(this).remove()}),e("#wall_photo_preview").find("#addMoreImage").hide();e(c).modal("hide"),h(i,o)}(e(this))}),e("#wallForm").on("click",".sticker_remove_select",function(){m()}),e(".comment_wrapper, #commentForm, #photoModal, #photo-content").on("click",".sticker_remove_select",function(){m(e(this).data("itemId"),e(this).data("itemType"))}),e(c).off("click",".sticker_category"),e(c).on("click",".sticker_category",function(){e("#sticker_search").val(e(this).data("key")),e(".sticker_search_cancel").show(),f()}),e(c).off("click",".sticker_search_cancel"),e(c).on("click",".sticker_search_cancel",function(){e("#sticker_search").val(""),e(".sticker_search_cancel").hide(),e(".sticker_category_container").show(),e("#sticker_search_content").empty()}),e(c).off("input","#sticker_search"),e(c).on("input","#sticker_search",function(){window.clearTimeout(o),o=window.setTimeout(_,350)}),e(c).off("change paste keyup","#sticker_search"),e(c).on("change paste keyup","#sticker_search",function(){""!=e(this).val().trim()?e(".sticker_search_cancel").show():(e(".sticker_search_cancel").hide(),e(".sticker_category_container").show())}),e("body").on("afterPostWallCallbackSuccess",function(){e("#list-content li:first .sticker_animation").length>0?(m(),d(e("#list-content li:first .sticker_animation"))):e("#wallForm").find("#sticker_post_feed").length>0&&m()});var t=[];for(var n in s){var p=s[n].afterCallback;-1===t.indexOf(p)&&(t.push(p),e("body").off(p),e("body").on(p,function(e,t){m(null!=t&&void 0!==t.targetId?t.targetId:0,null!=t&&void 0!==t.itemType?t.itemType:"")}))}e("body").on("enablePluginsCallback",function(t,i){i.plugins.indexOf(a)>-1&&e(".sticker_button").show()}),e("body").on("disablePluginsCallback",function(t,i){i.plugins.indexOf(a)>-1&&(e(".sticker_button").hide(),m())})},initEditComment:function(t,i,o){h(t,i);var a=s[t].beforeCallback;e("body").on(a,function(e,a){a.emptyContent=!0,a.targetId=i,a.itemType=t,a.params={sticker_image_id:o,empty_comment:1}})}}});