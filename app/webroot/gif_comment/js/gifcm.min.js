(function(a,g){"function"===typeof define&&define.amd?define("jquery mooFileUploader mooBehavior mooPhrase mooAjax mooGlobal mooTooltip slimScroll".split(" "),g):"object"===typeof exports?module.exports=g(require("jquery")):a.mooGifComment=g()})(this,function(a,g,B,C,n,D,E){var h=!0,p=function(){a(document).mouseup(function(b){var c=a(".gif_form_content_hoder");c.is(b.target)||0!==c.has(b.target).length||a(".gif_form_content_hoder").removeClass("show")})},v=function(){a(".gif-icon").unbind("click");
a(".gif-icon").click(function(){var b=a(this).data(),c=b.type;b=b.id;a(this).next().hasClass("show")?a(".gif_form_content_hoder").removeClass("show"):(a(".gif_form_content_hoder").removeClass("show"),a(this).next().addClass("show"));a(".gif_form > input").val("");u(c,b);q();p()})},u=function(b,c){n.get({url:"https://api.tenor.com/v1/trending?key=CQ30Q3LPLUGM&limit=10"},function(d){var e=[];a.each(d.results,function(a,b){e.push('<p class="gif_image_wraaper"><img class="gif_image" id="gif_img_'+b.id+
' " src=" '+b.media[0].tinygif.url+' " ></p>')});e.push('<p class="gif_load_more" data-id="'+c+'"  data-pos="'+d.next+'"  data-type="'+b+'" id="gif_load_more_'+b+"_"+c+'"><a href="javascript:void(0)"><span class="gif_loading" style="background-image:url('+mooConfig.url.base+'/img/indicator.gif);background-size:inherit;background-repeat:no-repeat"></span></a></p>');a("#gif_content_"+b+"_"+c).html(e);l(b,c);w(b,c);a(".initSlimScroll").slimScroll({height:"300px"});r(b,c)})},l=function(b,c){a(".gif_image").unbind("click");
a(".gif_image").click(function(){var d=a(this).attr("src"),e=a('<span id="attach_'+b+"_"+c+'_gif" style="background-image:url('+mooConfig.url.base+'/img/indicator.gif);background-size:inherit;background-repeat:no-repeat"></span>'),f=x(b,c),k=y(b,c),t=z(b,c);a(f).html(e);a(k).hide();n.post({url:mooConfig.url.base+"/gif_comments/upload_gif",data:{gif_link:d}},function(d){d=a.parseJSON(d);if(d.file){var e=a('<span id="attach_'+b+"_"+c+'_gif" style="background-image:url('+d.thumb+');background-size:inherit;background-repeat:no-repeat"></span>');
a(f).html(e);a(k).hide();var g=a('<a href="javascript:void(0);"><i class="material-icons thumb-review-delete">clear</i></a>');e.append(g);e.find(".thumb-review-delete").unbind("click");e.find(".thumb-review-delete").click(function(){e.remove();a(k).show();a(t).val("")});a(t).val(d.file)}else a(".error-message").show(),a(".error-message").html(d.message)})})},w=function(b,c){a("#gif_auto_search_"+b+"_"+c).keyup(function(){var d=a(this).val();2<=d.length&&a.ajax({type:"GET",url:"https://api.tenor.com/v1/search?q="+
d+"&key=CQ30Q3LPLUGM&limit=10",dataType:"json",success:function(e){var f=[];a.each(e.results,function(a,b){f.push('<p class="gif_image_wraaper"><img class="gif_image" id=" gif_img_'+b.id+' " src=" '+b.media[0].tinygif.url+' " ></p>')});f.push('<p class="gif_load_more" data-id="'+c+'" data-search="'+d+'"  data-pos="'+e.next+'"  data-type="'+b+'" id="gif_load_more_'+b+"_"+c+'"><a href="javascript:void(0)"><span class="gif_loading" style="background-image:url('+mooConfig.url.base+'/img/indicator.gif);background-size:inherit;background-repeat:no-repeat"></span></a></p>');
a("#gif_content_"+b+"_"+c).html(f);l(b,c);a(".initSlimScroll").slimScroll({height:"300px"});r(b,c)}})})},r=function(b,c){var d=a("#gif_content_"+b+"_"+c);0<d.length&&d.scroll(function(){var e=a("#gif_load_more_"+b+"_"+c),f=d.offset().top;300>e.offset().top-f&&h&&(m(),e.find("a").trigger("click"),h=!1)})},m=function(){a(".gif_load_more a").unbind("click");a(".gif_load_more a").click(function(){var b=a(this).parent().data();if(b.search)var c=b.search;A(b.type,b.id,b.pos,c)})},A=function(b,c,d,e){var f=
a("#gif_content_"+b+"_"+c);a.ajax({type:"GET",url:void 0!=e?"https://api.tenor.com/v1/search?q="+e+"&key=CQ30Q3LPLUGM&limit=10&pos="+d:"https://api.tenor.com/v1/trending?key=CQ30Q3LPLUGM&limit=10&pos="+d,dataType:"json",success:function(d){h=!0;a(".gif_load_more:first").remove();var g=[];a.each(d.results,function(a,b){g.push('<p class="gif_image_wraaper"><img class="gif_image" id=" gif_img_'+b.id+' " src=" '+b.media[0].tinygif.url+' " ></p>')});f.find(".gif_loading").remove();f.append(g);void 0!=
e?f.append('<p class="gif_load_more" data-search="'+e+'" data-id="'+c+'" data-pos="'+d.next+'"  data-type="'+b+'" id="gif_load_more_'+b+"_"+c+'"><a href="javascript:void(0)"><span class="gif_loading" style="background-image:url('+mooConfig.url.base+'/img/indicator.gif);background-size:inherit;background-repeat:no-repeat"></span></a></p>'):f.append('<p class="gif_load_more" data-id="'+c+'" data-pos="'+d.next+'"  data-type="'+b+'" id="gif_load_more_'+b+"_"+c+'"><a href="javascript:void(0)"><span class="gif_loading" style="background-image:url('+
mooConfig.url.base+'/img/indicator.gif);background-size:inherit;background-repeat:no-repeat"></span></a></p>');a(".initSlimScroll").slimScroll({height:"300px"});l(b,c);m()},error:function(b){a(".gif_load_more").remove()}})},x=function(a,c){var b="";switch(a){case "commentForm":b="#comment_preview_image_"+c;break;case "activity_comment_edit":b="#activity_comment_preview_attach_"+c;break;case "item_comment_edit":b="#item_comment_preview_attach_"+c}return b},y=function(a,c){var b="";switch(a){case "commentForm":b=
"#comment_button_attach_"+c;break;case "activity_comment_edit":b="#activity_comment_attach_"+c;break;case "item_comment_edit":b="#item_comment_attach_"+c}return b},z=function(a,c){var b="";switch(a){case "commentForm":b="#comment_image_"+c;break;case "activity_comment_edit":b="#activity_comment_attach_id_"+c;break;case "item_comment_edit":b="#item_comment_attach_id_"+c}return b},q=function(){a(".viewer-submit-comment").unbind("click");a(".viewer-submit-comment").click(function(){a(".gif_form_content_hoder").removeClass("show");
a(".gif_form > input").val("")});a(".commentButton > .btn").click(function(){a(".gif_form_content_hoder").removeClass("show");a(".gif_form > input").val("")});a(".commentButton > .mdl-button").click(function(){a(".gif_form_content_hoder").removeClass("show");a(".gif_form > input").val("")})};return{initLoadGif:function(){v()},autoCloseWhenOutsideClick:function(){p()},doClickLoadMore:function(){m()},closeGifWhenShareFeed:function(){q()}}});