!function(e,t){"function"==typeof define&&define.amd?define(["jquery","mooFileUploader","mooBehavior","mooAlert","mooPhrase","mooAjax","mooUser","mooGlobal","mooButton"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.store_manager=t()}(this,function(e,t,o,n,r,a,u,d,c){var l=function(t,o){e("input.multi_cb").removeAttr("checked"),e("#cb"+t).trigger("click"),"delete"==o?p(r.__("are_you_sure_you_want_to_delete"),function(){s(o)}):"create"==o?window.location=jQuery("#adminForm").attr("action")+o+"/"+t:s(o)},s=function(e){var t=jQuery("#adminForm").attr("action"),o=t+e;mooConfig.isApp&&(o=t+e+"?app_no_tab=1"),jQuery.post(o,jQuery("#adminForm").serialize(),function(){location.reload()})},p=function(t,o){e(e("#portlet-config  .modal-header .modal-title")[0]).html(r.__("please_confirm")),e(e("#portlet-config  .modal-body")[0]).html(t),e("#portlet-config  .modal-footer .ok").off("click").click(function(){o(),e("#portlet-config").modal("hide")}),e("#portlet-config").modal("show")},m=function(){new t.fineUploader({element:jQuery("#product_image")[0],multiple:!0,text:{uploadButton:'<div class="upload-section"><i class="material-icons">camera_enhance</i></i>'+r.__("drag_or_click_here_to_upload_photo")+"</div>"},validation:{allowedExtensions:mooConfig.photoExt,sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+"/stores/product_upload/images/"},callbacks:{onComplete:function(e,t,o){if(0==o.success)jQuery(".qq-upload-fail:last .qq-upload-status-text").empty().append(o.message);else{if(""!=o.filename){var n=jQuery(jQuery("#imgItemTemplate").html());n.find("img").attr("src",o.thumb),n.find(".image_filename").val(o.filename),n.find(".image_path").val(o.path),jQuery("#tbImage tbody").append(n)}f("tbImage")}}}});_("promotion_start","promotion_end"),b(),jQuery(document).on("click","#allow_promotion",function(){b()}),f("tbImage"),jQuery(document).on("click","#tbImage .btn-up",function(){var e=jQuery(this).closest("tr").prev();jQuery(this).closest("tr").insertBefore(e),f("tbImage")}),jQuery(document).on("click","#tbImage .btn-down",function(){var e=jQuery(this).closest("tr").next();jQuery(this).closest("tr").insertAfter(e),f("tbImage")}),f("tbVideo"),jQuery(document).on("click","#tbVideo .btn-up",function(){var e=jQuery(this).closest("tr").prev();jQuery(this).closest("tr").insertBefore(e),f("tbVideo")}),jQuery(document).on("click","#tbVideo .btn-down",function(){var e=jQuery(this).closest("tr").next();jQuery(this).closest("tr").insertAfter(e),f("tbVideo")}),function(){var e=jQuery("#videoData").html().trim();if((e=jQuery.parseJSON(e)).length>0){for(var t in e){var o=e[t].StoreProductVideo,n=jQuery(jQuery("#videoItemTemplate").html());n.find(".video_image").attr("src",o.image_url),n.find(".video_name").html(o.title),n.find(".product_video_id").val(o.id),n.find(".video_id").val(o.video_id),0==o.enable&&n.find(".enable_video").removeAttr("checked"),jQuery("#tbVideo tbody").append(n)}f("tbVideo")}}(),jQuery(document).on("click","#btnShowAttrDlg",function(){h(1,"#attribute_buy")}),jQuery(document).on("click","#btnAddAttr",function(){y()}),jQuery(document).on("click",".remove_attribute",function(){jQuery(this).closest(".form-group").remove()}),jQuery(document).on("click",".remove_added_attribute",function(){var e=jQuery(this).data("id");jQuery(this).closest(".form-group").remove();var t=jQuery.parseJSON(jQuery("#attributeData").html());for(var o in t)t[o].attribute_id==e&&t.splice(o,1);jQuery("#attributeData").html(JSON.stringify(t))}),jQuery(document).on("click","#btnSave",function(){j()}),jQuery(document).on("click","#btnApply",function(){j(1)}),jQuery(document).on("click",".delete_image",function(){Q(jQuery(this))}),jQuery(document).on("click",".delete_video",function(){v(jQuery(this))}),jQuery(document).on("change","#product_type",function(){switch(jQuery(this).val()){case r.__("STORE_PRODUCT_TYPE_DIGITAL"):jQuery(".for_digital_product").show(),jQuery(".for_link_product").hide();break;case r.__("STORE_PRODUCT_TYPE_LINK"):jQuery(".for_digital_product").hide(),jQuery(".for_link_product").show();break;default:jQuery(".for_digital_product").hide(),jQuery(".for_link_product").hide()}});new t.fineUploader({element:jQuery("#product_digital_file")[0],autoUpload:!0,text:{uploadButton:'<div class="upload-section"><i class="material-icons">attachment</i>'+r.__("drag_or_click_here_to_upload_file")+"</div>"},validation:{allowedExtensions:r.__("store_allow_digital_file_extensions").split(","),sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+"/stores/product_upload/files"},callbacks:{onError:d.errorHandler,onComplete:function(e,t,o){jQuery("#digital_file").val(o.filename),jQuery("#product_digital_file_preview").html(o.filename).show()}}});jQuery(document).on("click","#btn_select_video",function(e){jQuery("#storeModal").modal("show"),g()}),jQuery(document).on("click","#video-short-list-paging li a",function(e){e.stopPropagation(),e.preventDefault(),g(jQuery(this).attr("href"))}),jQuery(document).on("click","#search_video_short_list",function(e){""!=jQuery("#videoShortListForm #keyword").val()&&g()}),jQuery(document).on("click",".select_video",function(e){var t=jQuery(this),o=jQuery(jQuery("#videoItemTemplate").html());o.find(".video_image").attr("src",t.data("image")),o.find(".video_name").html(t.data("title")),o.find(".video_id").val(t.data("id")),jQuery("#tbVideo tbody").append(o),f("tbVideo"),jQuery("#storeModal").modal("hide")}),jQuery("#storeModal").on("hidden.bs.modal",function(){jQuery("#storeModal .modal-body").empty()})};function y(e){if(void 0!==e&&""!=e)for(var t in e=jQuery.parseJSON(e)){var o=e[t];(n=jQuery(jQuery("#attributeDataTemplate").html())).find(".attribute_id").val(o.attribute_id),n.find(".plus").val(o.plus),n.find(".attribute_price").val(o.attribute_price),jQuery("#attributes_content").append(n)}else{var n=jQuery(jQuery("#attributeDataTemplate").html());jQuery("#attributes_content").append(n)}}var _=function(e,t){jQuery("#"+e).datepicker({changeMonth:!0,onClose:function(e){jQuery("#"+t).datepicker("option","minDate",e)}}),jQuery("#"+t).datepicker({changeMonth:!0,onClose:function(t){jQuery("#"+e).datepicker("option","maxDate",t)}})},f=function(e){jQuery("#"+e+" tbody tr").find(".btn-up").show(),jQuery("#"+e+" tbody tr").find(".btn-down").show(),jQuery("#"+e+" tbody tr:first-child").find(".btn-up").hide(),jQuery("#"+e+" tbody tr:last-child").find(".btn-down").hide()},h=function(t,o){(o=jQuery(o)).length>0&&(o=o.val()),jQuery("#storeModal").modal({backdrop:"static"}),e.post(mooConfig.url.base+"/stores/manager/attributes/select_list/"+t,"ids="+o,function(e){jQuery("#storeModal .modal-content").empty().append(e),""!=jQuery("#attributeData").text().trim()&&y(jQuery("#attributeData").text().trim())})},j=function(t){for(c.disableButton("btnSave"),c.disableButton("btnApply"),c.disableButton("btnCancel"),e(".error-message").hide(),e(".alert-success").hide(),i=0;i<tinyMCE.editors.length;i++){var o=tinyMCE.editors[i].getContent();jQuery("#"+tinyMCE.editors[i].id).val(o)}1==t&&jQuery("#save_type").val(1);var n=-1;jQuery("#tbImage tbody .is_main").each(function(){n++,jQuery(this).is(":checked")&&jQuery(this).val(n)});n=-1;jQuery("#tbImage tbody .enable_image").each(function(){n++,jQuery(this).is(":checked")&&jQuery(this).val(n)});n=-1;jQuery("#tbVideo tbody .enable_video").each(function(){n++,jQuery(this).is(":checked")&&jQuery(this).val(n)}),e.post(mooConfig.url.base+"/stores/manager/products/save",e("#formProduct").serialize(),function(o){var n=e.parseJSON(o);0==n.result?(e(".error-message").show(),e(".error-message").html(n.message),c.enableButton("btnSave"),c.enableButton("btnApply"),c.enableButton("btnCancel")):mooConfig.isApp?1==t?window.location=n.location+"?app_no_tab=1":window.mobileAction.backAndRefesh():window.location=n.location})},b=function(){jQuery("#allow_promotion").is(":checked")?jQuery(".promotion-group").show():jQuery(".promotion-group").hide()},Q=function(e){jQuery(e).closest("tr").remove(),f("tbImage")},v=function(e){jQuery(e).closest("tr").remove(),f("tbVideo")};var g=function(t){void 0===t&&(t=mooConfig.url.base+"/stores/manager/products/select_video");var o=[];jQuery("#tbVideo .video_id").length>0&&jQuery("#tbVideo .video_id").each(function(){o.push(jQuery(this).val())}),e.post(t,e("#videoShortListForm").serialize()+"&data[except_id]="+o.join(),function(e){jQuery("#storeModal .modal-content").empty().append(e)})},k=function(){_("datetime_start","datetime_end"),jQuery(document).on("change",".change_order_status",function(){var t=jQuery(this).val();jQuery.post(mooConfig.url.base+"/stores/manager/orders/change_order_status","order_id="+jQuery(this).data("id")+"&status="+t,function(o){var i=e.parseJSON(o);0==i.result?(jQuery(item).val(t),n.alert(i.message)):n.alert(i.message)})}),jQuery(document).on("click",".view_order_detail",function(){jQuery.post(mooConfig.url.base+"/stores/manager/orders/order_detail/"+jQuery(this).data("id"),"",function(e){jQuery("#storeModal .modal-content").empty().append(e),jQuery("#storeModal").modal()})}),jQuery(document).on("click",".print_order",function(){window.open(mooConfig.url.base+"/stores/orders/print_order/"+jQuery(this).data("id"),"_blank","location=yes")})};initCreateAttribute=function(){jQuery(document).on("click","#btnSave",function(){w()}),jQuery(document).on("click","#btnApply",function(){w(1)})};var w=function(t){c.disableButton("btnSave"),c.disableButton("btnApply"),c.disableButton("btnCancel"),e(".error-message").hide(),e(".alert-success").hide(),1==t&&jQuery("#save_type").val(1),e.post(mooConfig.url.base+"/stores/manager/attributes/save",e("#formAttribute").serialize(),function(o){var n=e.parseJSON(o);0==n.result?(e(".error-message").show(),e(".error-message").html(n.message),c.enableButton("btnSave"),c.enableButton("btnApply"),c.enableButton("btnCancel")):mooConfig.isApp?1==t?window.location=n.location+"?app_no_tab=1":window.mobileAction.backAndRefesh():window.location=n.location})};initCreateProducer=function(){jQuery(document).on("click","#btnSave",function(){C()}),jQuery(document).on("click","#btnApply",function(){C(1)})};var C=function(t){c.disableButton("btnSave"),c.disableButton("btnApply"),c.disableButton("btnCancel"),e(".error-message").hide(),e(".alert-success").hide(),1==t&&jQuery("#save_type").val(1),e.post(mooConfig.url.base+"/stores/manager/producers/save",e("#createForm").serialize(),function(o){var n=e.parseJSON(o);0==n.result?(e(".error-message").show(),e(".error-message").html(n.message),c.enableButton("btnSave"),c.enableButton("btnApply"),c.enableButton("btnCancel")):mooConfig.isApp?1==t?window.location=n.location+"?app_no_tab=1":window.mobileAction.backAndRefesh():window.location=n.location})};function A(e){if(void 0!==e&&""!=e)for(var t in e=jQuery.parseJSON(e)){var o,n=e[t].StoreShipping;(o=jQuery(jQuery("#zoneDataTemplate").html())).find(".store_shipping_zone_id").val(n.store_shipping_zone_id),o.find(".price").val(n.price),o.find(".weight").val(n.weight),1==n.enable&&o.find(".enable_zone").attr("checked","checked"),jQuery("#zone_content").append(o)}else B(o=jQuery(jQuery("#zoneDataTemplate").html()),"zone_content","store_shipping_zone_id"),jQuery("#zone_content").append(o);S("zoneDataTemplate","btnAddZone","zone_content","store_shipping_zone_id")}function S(e,t,o,n){var i=[];jQuery("#"+o+" ."+n).each(function(){i.push(parseInt(jQuery(this).val()))}),jQuery("#"+o+" ."+n).each(function(){var e=jQuery(this),t=parseInt(e.val());e.find("option").each(function(){var e=parseInt(jQuery(this).val());jQuery(this).show(),i.indexOf(e)>-1&&t!=e&&jQuery(this).hide()})}),jQuery(jQuery("#"+e).html()).find("."+n+" option").length==jQuery("#"+o+" ."+n).length?jQuery("#"+t).attr("disabled","disabled"):jQuery("#btnAddZone").removeAttr("disabled")}function B(e,t,o){var n=e.find("."+o),i=[];jQuery("#"+t+" ."+o).each(function(){i.push(parseInt(jQuery(this).val()))});var r=0;n.find("option").each(function(){var e=parseInt(jQuery(this).val());i.indexOf(e)>-1?jQuery(this).hide():0==r&&(r=1,jQuery(this).attr("selected","selected"))})}initCreateShipping=function(){jQuery(document).on("click","#btnSave",function(){z()}),jQuery(document).on("click","#btnApply",function(){z(1)}),""!=jQuery("#zoneData").text().trim()&&A(jQuery("#zoneData").text().trim()),jQuery(document).on("click","#btnAddZone",function(){A()}),jQuery(document).on("click",".remove_zone",function(){jQuery(this).closest(".div-detail-row").remove(),S("zoneDataTemplate","btnAddZone","zone_content","store_shipping_zone_id")}),jQuery(document).on("change","#zone_content .store_shipping_zone_id",function(){S("zoneDataTemplate","btnAddZone","zone_content","store_shipping_zone_id")})};var z=function(t){c.disableButton("btnSave"),c.disableButton("btnApply"),c.disableButton("btnCancel"),e(".error-message").hide(),e(".alert-success").hide(),1==t&&jQuery("#save_type").val(1),jQuery("#zone_content .enable_zone").each(function(){jQuery(this).is(":checked")?jQuery(this).parent().find("input[type=hidden]").attr("disabled","disabled"):jQuery(this).attr("disabled","disabled")}),e.post(mooConfig.url.base+"/stores/manager/shippings/save",e("#createForm").serialize(),function(o){var n=e.parseJSON(o);0==n.result?(e(".error-message").show(),e(".error-message").html(n.message),c.enableButton("btnSave"),c.enableButton("btnApply"),c.enableButton("btnCancel"),jQuery("#zone_content .enable_zone").each(function(){jQuery(this).parent().find("input[type=hidden]").removeAttr("disabled"),jQuery(this).removeAttr("disabled")})):mooConfig.isApp?1==t?window.location=n.location+"?app_no_tab=1":window.mobileAction.backAndRefesh():window.location=n.location})};function x(e){if(void 0!==e&&""!=e)for(var t in e=jQuery.parseJSON(e)){var o,n=e[t];(o=jQuery(jQuery("#locationDataTemplate").html())).find(".country_id").val(n.country_id),1==n.enable&&o.find(".enable_location").attr("checked","checked"),jQuery("#location_content").append(o)}else B(o=jQuery(jQuery("#locationDataTemplate").html()),"location_content","country_id"),jQuery("#location_content").append(o);S("locationDataTemplate","btnAddLocation","location_content","country_id")}initCreateShippingZone=function(){jQuery(document).on("click","#btnSave",function(){O()}),jQuery(document).on("click","#btnApply",function(){O(1)}),""!=jQuery("#locationData").text().trim()&&x(jQuery("#locationData").text().trim()),jQuery(document).on("click","#btnAddLocation",function(){x()}),jQuery(document).on("click",".remove_location",function(){jQuery(this).closest(".div-detail-row").remove(),S("locationDataTemplate","btnAddLocation","location_content","country_id")}),jQuery(document).on("change","#location_content .country_id",function(){S("locationDataTemplate","btnAddLocation","location_content","country_id")})};var O=function(t){c.disableButton("btnSave"),c.disableButton("btnApply"),c.disableButton("btnCancel"),e(".error-message").hide(),e(".alert-success").hide(),1==t&&jQuery("#save_type").val(1),jQuery("#location_content .enable_location").each(function(){jQuery(this).is(":checked")?jQuery(this).parent().find("input[type=hidden]").attr("disabled","disabled"):jQuery(this).attr("disabled","disabled")}),e.post(mooConfig.url.base+"/stores/manager/shipping_zones/save",e("#createForm").serialize(),function(o){var n=e.parseJSON(o);0==n.result?(e(".error-message").show(),e(".error-message").html(n.message),c.enableButton("btnSave"),c.enableButton("btnApply"),c.enableButton("btnCancel"),jQuery("#location_content .enable_zone").each(function(){jQuery(this).parent().find("input[type=hidden]").removeAttr("disabled"),jQuery(this).removeAttr("disabled")})):mooConfig.isApp?1==t?window.location=n.location+"?app_no_tab=1":window.mobileAction.backAndRefesh():window.location=n.location})},I="";function D(){jQuery.post(mooConfig.url.base+"/stores/manager/shippings/load_order_shippings/","country_id="+jQuery("#shipping_country_id").val()+"&select_id="+jQuery("#select_store_shipping_id").val(),function(e){jQuery("#order_shipping").html(e)})}initCreateOrder=function(){jQuery(document).on("click","#btnSave",function(){R()}),jQuery(document).on("click","#btnApply",function(){R(1)}),jQuery(document).on("click",".copy_order_btn",function(){var e=jQuery("#createForm");e.find("#shipping_email").val(e.find("#billing_email").val()),e.find("#shipping_first_name").val(e.find("#billing_first_name").val()),e.find("#shipping_last_name").val(e.find("#billing_last_name").val()),e.find("#shipping_company").val(e.find("#billing_company").val()),e.find("#shipping_phone").val(e.find("#billing_phone").val()),e.find("#shipping_address").val(e.find("#billing_address").val()),e.find("#shipping_country_id").val(e.find("#billing_country_id").val()),e.find("#shipping_city").val(e.find("#billing_city").val()),e.find("#shipping_postcode").val(e.find("#billing_postcode").val()),D()}),jQuery("#order-detail-form #quantity").on("keydown",function(e){var t=null;if((t=window.event?window.event.keyCode:e.which)<48||t>57){if(8==t||127==t||0==t)return;return!1}}),jQuery(document).on("click","#product-short-list-paging li a",function(e){e.stopPropagation(),e.preventDefault(),T(jQuery(this).attr("href"))}),M(),jQuery(document).on("change","#payment",function(e){M()}),jQuery(document).on("click",".order_detail_dialog",function(e){N(jQuery(this).data("id"))}),jQuery(document).on("click",".clear_order_detail",function(e){V(jQuery(this).data("id"))}),jQuery(document).on("change","#order-detail-form #quantity",function(e){J()}),jQuery(document).on("click","#add_order_detail",function(e){var t=jQuery("#order-detail-form"),o=t.find("#product_id").val(),i=t.find("#product_code").val(),a=t.find("#product_name").val(),u=t.find("#price").val(),d=t.find("#quantity").val(),c=t.find("#amount").val(),l=t.find("#weight").val();d<1?(jQuery("#order_detail_modal").modal("hide"),n.alert(r.__("text_invalid_quantity")),jQuery(document).on("click","#simple-modal .button-action.primary",function(){jQuery("#order_detail_modal").modal("show")})):o>0?(jQuery("#order_detail_modal").modal("hide"),P(o,i,a,u,d,c,l),E(o),L(I)):(jQuery("#order_detail_modal").modal("hide"),n.alert(r.__("text_please_select_product")),jQuery(document).on("click","#simple-modal .button-action.primary",function(){jQuery("#order_detail_modal").modal("show")}))}),jQuery(document).on("click",".load_product_short_list",function(e){T()}),jQuery(document).on("click",".select_product",function(t){var o=e(this).find(".product_list").data();q(o.id,o.productCode,o.name,o.price),jQuery("#order_detail_modal").modal("show"),jQuery("#product_short_list").modal("hide")});var t=jQuery("#data-products").html().trim();if(""!=t)for(var o in t=jQuery.parseJSON(t)){var i=t[o];P(i.product_id,i.product_code,i.product_name,i.price,i.quantity,i.amount,i.weight)}jQuery("#select_store_shipping_id").length>0&&(D(),jQuery(document).on("change","#shipping_country_id",function(){D()}))};var F=function(e){switch(currency_position){case"left":e=currency_symbol+e;break;case"right":e+=currency_symbol;break;default:e=currency_symbol+e}return e},T=function(t){jQuery("#order_detail_modal").modal("hide"),jQuery("#product_short_list").modal("show"),void 0===t&&(t=mooConfig.url.base+"/stores/manager/products/product_short_list"),e.post(t,e("#productShortListForm").serialize()+"&except_id="+jQuery("#except_product_ids").val(),function(e){jQuery("#product_short_list .modal-content").empty().append(e)})},M=function(){1==jQuery("#payment option:selected").data("online")?jQuery("#payment_transaction_id").show():jQuery("#payment_transaction_id").hide()},N=function(e){if(void 0===e)I="",q("","","","");else{I=e;var t=jQuery("#product"+e),o=t.find(".product_code").data("value"),n=t.find(".product_name").data("value"),i=t.find(".price").data("value"),r=t.find(".quantity").data("value");q(e,o,n,i,r)}jQuery("#order_detail_modal").modal({backdrop:"static"})},q=function(e,t,o,n,i){void 0===i&&(i=1);var r=jQuery("#order-detail-form");r.find("#product_id").val(e),r.find("#product_code").val(t),r.find("#product_name").val(o),r.find("#price").val(n),r.find("#quantity").val(i),J()},J=function(){var e=jQuery("#order-detail-form"),t=e.find("#price").val(),o=e.find("#quantity").val(),n=parseFloat(t)*parseInt(o);n=isNaN(n)?0:n,e.find("#amount").val(n.toFixed(2))},P=function(e,t,o,n,i,r,a){var u=jQuery(jQuery("#data-template").html());u.attr("id",u.data("value")+e),u.find(".product_code").attr("data-value",t).empty().append(t),u.find(".product_name").attr("data-value",o).empty().append(o),u.find(".price").attr("data-value",n).empty().append(n),u.find(".quantity").attr("data-value",i).empty().append(i),u.find(".amount").attr("data-value",r).empty().append(r),u.find(".quantity_value").val(i).attr("name","data[quantity]["+e+"]"),u.find(".weight").val(a),u.find(".product_id_value").val(e),u.find(".edit").attr("data-id",e),u.find(".delete").attr("data-id",e),I>0?jQuery("#table-order-details #product"+I).after(u).remove():u=jQuery("#table-order-details").append(u)},V=function(e){p(r.__("are_you_sure_you_want_to_delete"),function(){jQuery("#product"+e).remove(),L(e)})},E=function(e){var t=[];""!=jQuery("#except_product_ids").val()&&(t=jQuery("#except_product_ids").val().split(",")),t.push(e),jQuery("#except_product_ids").val(t.join(","))},L=function(e){var t=jQuery("#except_product_ids").val().split(","),o=t.indexOf(e.toString());o>-1&&t.splice(o,1),jQuery("#except_product_ids").val(t.join(","))},R=function(t){c.disableButton("btnSave"),c.disableButton("btnApply"),c.disableButton("btnCancel"),e(".error-message").hide(),e(".alert-success").hide(),1==t&&jQuery("#save_type").val(1),e.post(mooConfig.url.base+"/stores/manager/orders/save",e("#createForm").serialize(),function(o){var n=e.parseJSON(o);0==n.result?(e(".error-message").show(),e(".error-message").html(n.message),c.enableButton("btnSave"),c.enableButton("btnApply"),c.enableButton("btnCancel")):mooConfig.isApp?1==t?window.location=n.location+"?app_no_tab=1":window.mobileAction.backAndRefesh():window.location=n.location})};function U(e){try{JSON.parse(e)}catch(e){return!1}return!0}return{initHelp:function(){"undefined"!=typeof helps&&(helps=jQuery.parseJSON(helps),jQuery(".help-tip").each(function(){var e=jQuery(this).data("tip").toString();helps[e]&&jQuery(this).empty().append("<p>"+helps[e]+"</p>")}))},initManagerMenu:function(){jQuery(document).on("click","#load_manager_menu",function(){jQuery.post(mooConfig.url.base+"/stores/manager/load_manager_menu","",function(t){jQuery("#storeModal .modal-content").empty().append(t),jQuery("#storeModal").modal(),e("#side-menu-dialog").metisMenu()})}),jQuery("#side-menu").length>0&&jQuery("#side-menu").metisMenu(),jQuery(document).on("click","#delete_seller",function(){p(r.__("text_confirm_delete_seller"),function(){var e=mooConfig.url.base+"/stores/manager/delete";mooConfig.isApp&&(e+="?app_no_tab=1"),window.location=e})}),jQuery(document).on("click",".buy_featured_product",function(){var e=jQuery(this);p(jQuery("#buy_feature_product_confirm").html(),function(){var t=mooConfig.url.base+"/stores/manager/store_packages/buy_featured_product/"+e.data("id");mooConfig.isApp&&(t+="?app_no_tab=1"),jQuery.post(t,jQuery("#adminForm").serialize(),function(e){if(U(e)){var t=jQuery.parseJSON(e);if(0==t.result)n.alert(t.message);else{var o=mooConfig.url.base+t.redirect;mooConfig.isApp&&(o+="?app_no_tab=1"),window.location=o}}else location.reload()})})}),jQuery(document).on("click",".buy_featured_store",function(){p(jQuery("#buy_feature_store_confirm").html(),function(){var e=mooConfig.url.base+"/stores/manager/store_packages/buy_featured_store/";mooConfig.isApp&&(e+="?app_no_tab=1"),jQuery.post(e,jQuery("#adminForm").serialize(),function(e){if(U(e)){var t=jQuery.parseJSON(e);if(0==t.result)n.alert(t.message);else{var o=mooConfig.url.base+t.redirect;mooConfig.isApp&&(o+="?app_no_tab=1"),window.location=o}}else location.reload()})})})},initManage:function(){jQuery(document).on("click",".group_checkbox",function(){jQuery(this).is(":checked")?jQuery(".multi_cb").trigger("click"):jQuery(".multi_cb").removeAttr("checked")}),jQuery(document).on("click","#delete_all",function(){jQuery("input.multi_cb:checked").length<1?n.alert(r.__("you_must_select_at_least_an_item")):p(r.__("are_you_sure_you_want_to_delete"),function(){s("delete")})}),jQuery(document).on("click","#enable_all",function(){jQuery("input.multi_cb:checked").length<1?n.alert(r.__("you_must_select_at_least_an_item")):s("enable")}),jQuery(document).on("click","#disable_all",function(){jQuery("input.multi_cb:checked").length<1?n.alert(r.__("you_must_select_at_least_an_item")):s("disable")}),jQuery(document).on("click","#ordering_all",function(){jQuery("input.multi_cb:checked").length<1?n.alert(r.__("you_must_select_at_least_an_item")):s("ordering")}),jQuery(document).on("click",".action_delete",function(){l(jQuery(this).data("id"),"delete")}),jQuery(document).on("click",".action_enable",function(){l(jQuery(this).data("id"),"enable")}),jQuery(document).on("click",".action_disable",function(){l(jQuery(this).data("id"),"disable")}),mooConfig.isApp&&jQuery(document).on("submit","#searchForm",function(){return e("<input />").attr("type","hidden").attr("name","app_no_tab").attr("value",1).appendTo("#searchForm"),!0})},initCreateAttribute:function(){initCreateAttribute()},initCreateProducer:function(){initCreateProducer()},initCreateProduct:function(){m()},initCreateOrder:function(){initCreateOrder()},initManageOrder:function(){k()},loadDetailHtml:function(e,t,o,n,i,r,a){P(e,t,o,n,i,r,a)},loadProductAttributes:function(t,o){var n,i;n=t,i=o,e.post(mooConfig.url.base+"/stores/manager/attributes/show_select_list","product_id="+n+"&buy="+i,function(e){1==i?jQuery("#attributeToBuy").empty().append(e):jQuery("#attributeList").empty().append(e)})},initSelectAttributeDlg:function(){jQuery(document).on("click",".attribute_parent",function(){var e=jQuery(this).data("id");jQuery(".attribute_group"+e).removeAttr("checked","checked"),jQuery("#attribute_parent"+e).is(":checked")&&jQuery(".attribute_group"+e).trigger("click")}),jQuery(document).on("click",".attribute_group",function(){var e=jQuery(this).data("id");jQuery(".attribute_group"+e+":checked").length>0?jQuery("#attribute_parent"+e).prop("checked",!0):jQuery("#attribute_parent"+e).removeAttr("checked")}),jQuery(document).on("click","#btnAttrSave",function(){var t=jQuery(this).data("buy");jQuery(".attribute_parent").each(function(){jQuery(".attribute_group"+jQuery(this).val()+":checked").length>0&&jQuery(this).prop("checked",!0)}),e.post(mooConfig.url.base+"/stores/manager/attributes/show_select_list",e("#formSelect").serialize(),function(e){if(U(e)){var o=jQuery.parseJSON(e);jQuery("#attributeMessage").html(o.message).show()}else 1==t?jQuery("#attributeToBuy").empty().append(e):jQuery("#attributeList").empty().append(e),jQuery("#storeModal").modal("hide")})})},initCreateShipping:function(){initCreateShipping()},initCreateShippingZone:function(){initCreateShippingZone()},calculateShippingPrice:function(){jQuery(".shipping_price").each(function(){var e=parseFloat(jQuery(this).data("price")),t=parseFloat(jQuery(this).data("weight")),o=jQuery(this).data("key");if(o==r.__("STORE_SHIPPING_PER_ITEM")){var n=0;jQuery(".div-detail-row").each(function(){n+=parseInt(jQuery(this).find(".quantity").data("value"))}),e*=n}if(o==r.__("STORE_SHIPPING_WEIGHT")){var i=0;jQuery(".div-detail-row").each(function(){i+=parseInt(jQuery(this).find(".quantity").data("weight"))*parseInt(jQuery(this).find(".quantity").data("value"))}),(0==t||t>0&&i<t)&&(e=0)}jQuery(this).html(F(e))})},initUploadVideo:function(){e("#fetchButton").unbind("click"),e("#fetchButton").click(function(){return e("#fetchButton").spin("small"),e("#videoForm .error-message").hide(),c.disableButton("fetchButton"),a.post({url:mooConfig.url.base+"/stores/manager/products/video_validate",data:e("#createForm").serialize()},function(t){c.enableButton("fetchButton"),t?(e("#fetchForm .error-message").html(JSON.parse(t).error),e("#fetchForm .error-message").show(),e("#fetchButton").spin(!1)):a.post({url:mooConfig.url.base+"/stores/manager/products/video_fetch",data:e("#createForm").serialize()},function(t){c.enableButton("fetchButton"),e("#fetchForm").slideUp(),e("#videoForm").html(t)})}),!1})},initAfterFetchVideo:function(){e("#saveBtn").unbind("click"),e("#saveBtn").click(function(){e(this).addClass("disabled"),c.disableButton("saveBtn"),a.post({url:mooConfig.url.base+"/stores/manager/products/save_video/",data:e("#createForm").serialize()},function(t){var o=e.parseJSON(t);if(1==o.result){var n=jQuery(jQuery("#videoItemTemplate").html());n.find(".video_image").attr("src",o.video.image_url),n.find(".video_name").html(o.video.title),n.find(".video_id").val(o.video.id),jQuery("#tbVideo tbody").append(n),f("tbVideo"),jQuery("#storeModal").modal("hide")}else c.enableButton("saveBtn"),e("#videoForm .error-message").show(),e("#videoForm .error-message").html(o.message),e(".spinner").length>0&&e(".spinner").remove()})})}}});